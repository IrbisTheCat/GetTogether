if (self.CavalryLogger) { CavalryLogger.start_js(["bg9Ma"]); }

/** __static_js_modules__/chatnotificationconstants.js */




__d("ChatNotificationConstants",[],(function a(b,c,d,e,f,g){

f.exports={NORMAL:0,NO_USER_MESSAGE_NOTIFICATION:1};}),

null);

/** __static_js_modules__/mercuryattachmenttype.js */




__d("MercuryAttachmentType",[],(function a(b,c,d,e,f,g){

f.exports={ERROR:"error",FILE:"file",PHOTO:"photo",STICKER:"sticker",SHARE:"share",UNKNOWN:"unknown",VIDEO:"video",ANIMATED_IMAGE:"animated_image",EMOJI_LIKE:"emoji_like",GIFT:"gift",THIRDPARTYSTICKER:"third_party_sticker"};}),

null);

/** __static_js_modules__/mercurymessagesourcetags.js */




__d("MercuryMessageSourceTags",[],(function a(b,c,d,e,f,g){

f.exports={CHAT:"source:chat",EMAIL:"source:email",MESSENGER:"source:messenger",MOBILE:"source:mobile"};}),

null);

/** __static_js_modules__/mercurysendmessagefields.js */




__d("MercurySendMessageFields",[],(function a(b,c,d,e,f,g){

f.exports={AUTO_RETRY_CNT:"auto_retry_cnt",MANUAL_RETRY_CNT:"manual_retry_cnt"};}),

null);

/** __static_js_modules__/mercurytypeaheadconstants.js */




__d("MercuryTypeaheadConstants",[],(function a(b,c,d,e,f,g){

f.exports={COMPOSER_FRIENDS_MAX:4,COMPOSER_FB4C_MAX:4,COMPOSER_NON_FRIENDS_MAX:2,COMPOSER_MESSENGER_ONLY_CONTACT_MAX:4,COMPOSER_SHOW_MORE_LIMIT:2,COMPOSER_THREADS_INITIAL_LIMIT:2,COMPOSER_CHATTAB_MAX:5,COMPOSER_PAGES_MAX:5,COMPOSER_WM_MAX:19,USER_TYPE:"user",PAGE_TYPE:"page",THREAD_TYPE:"thread",HEADER_TYPE:"header",SEARCH_TYPE:"search",FRIEND_TYPE:"friend",NON_FRIEND_TYPE:"non_friend",FB4C_TYPE:"fb4c",MEETING_ROOM_PAGE_TYPE:"meeting_room_page",COMMERCE_PAGE_TYPE:"commerce_page",INTERNAL_BOT_PAGE_TYPE:"internal_bot_page",GAME_TYPE:"game",VALID_EMAIL:"^([A-Z0-9._\u0025+-]+\u0040((?!facebook\\.com))[A-Z0-9.-]+\\.[A-Z]{2,4}|(([A-Z._\u0025+-]+[A-Z0-9._\u0025+-]*)|([A-Z0-9._\u0025+-]+[A-Z._\u0025+-]+[A-Z0-9._\u0025+-]*))\u0040(?:facebook\\.com))$"};}),

null);

/** __static_js_modules__/messagingevent.js */




__d("MessagingEvent",[],(function a(b,c,d,e,f,g){

f.exports={DELETE:"delete",DELETE_MESSAGES:"delete_messages",DELIVER:"deliver",ERROR:"error",READ:"read",REPORT_SPAM:"report_spam",REPORT_SPAM_MESSAGES:"report_spam_messages",UNMARK_SPAM:"unmark_spam",SUBSCRIBE:"subscribe",CHANGE_MUTE_SETTINGS:"change_mute_settings",TAG:"tag",UNREAD:"unread",UNSUBSCRIBE:"unsubscribe",DELIVER_LOG:"deliver_log",MORE_THREADS:"more_threads",READ_ALL:"read_all",READ_RECEIPT:"read_receipt",DELIVERY_RECEIPT:"delivery_receipt",SENT_PUSH:"sent_push",DELIVER_FAST_PAST:"deliver_fast_path",MESSENGER_STATUS:"messenger_status",UPDATE_PINNED_THREADS:"update_pinned_threads",CHANGE_PAGE_THREAD_FLAG:"change_page_thread_flag",CREATE_PAGE_ADMIN_NOTE:"create_page_admin_note",NO_OP:"no_op"};}),

null);

/** __static_js_modules__/messengerapprovalmodetypes.js */




__d("MessengerApprovalModeTypes",[],(function a(b,c,d,e,f,g){

f.exports={OPEN:0,APPROVALS:1};}),

null);

/** __static_js_modules__/messengerjoinablemodetype.js */




__d("MessengerJoinableModeType",[],(function a(b,c,d,e,f,g){

f.exports={PRIVATE:0,JOINABLE:1};}),

null);

/** __static_js_modules__/omnimactiontype.js */




__d("OmniMActionType",[],(function a(b,c,d,e,f,g){

f.exports={CREATE_EVENT:1,LOCATION:2,PAYMENT:3,POLL:4,STICKER:5,TEXT:6,TRANSPORTATION:7,ORDER_FOOD:8,MAKE_RESERVATION:9,SCHEDULE_CALL:10,LIVE_LOCATION:11,VIDEO_CALL:12,VOICE_CALL:13,SAVE_CONTENT:14,PLAY_GAME:15,SHARE_CONTACT:16,SEND_PHOTO:17,CREATE_REMINDER:18};}),

null);

/** __static_js_modules__/omnimdirectivetype.js */




__d("OmniMDirectiveType",[],(function a(b,c,d,e,f,g){

f.exports={ADD_ACTIONS:1,CLEAR_ACTIONS:2,ADD_RANGES:3,INVOKE_NATIVE_AGENT:4,MUTATE_FLOW_STATE:5};}),

null);

/** __static_js_modules__/omnimloggerevents.js */




__d("OmniMLoggerEvents",[],(function a(b,c,d,e,f,g){

f.exports={MESSAGE_ANALYZED:"omni_m_message_analyzed",INTENT_DETECTED:"omni_m_intent_detected",INTENT_HANDLED:"omni_m_intent_handled",SUGGESTION_GENERATED:"omni_m_suggestion_generated",SUGGESTION_SENT:"omni_m_suggestion_sent",SUGGESTION_DISPLAYED:"omni_m_suggestion_displayed",SUGGESTION_CLICKED:"omni_m_suggestion_clicked",SUGGESTION_COMPLETED:"omni_m_suggestion_completed",SUGGESTION_DISMISSED:"omni_m_suggestion_dismissed",SUGGESTION_DISAPPEARED:"omni_m_suggestion_disappeared",BAR_DISMISSED:"omni_m_bar_dismissed",BAR_DISPLAYED:"omni_m_bar_displayed",BAR_DISAPPEARED:"omni_m_bar_disappeared",ORGANIC_CLICKED:"omni_m_organic_clicked",ORGANIC_COMPLETED:"omni_m_organic_completed"};}),

null);

/** __static_js_modules__/stickerconstants.js */




__d("StickerConstants",[],(function a(b,c,d,e,f,g){

f.exports={MOBILE_LIKE_STICKER_PACK_ID:"227877430692340",GRAVEYARD_PACK_ID:"604597256247273",LIKE_STICKER_ID:"227878347358915",HOT_LIKE_SMALL_STICKER_ID:"369239263222822",HOT_LIKE_MEDIUM_STICKER_ID:"369239343222814",HOT_LIKE_LARGE_STICKER_ID:"369239383222810",MRU_STICKER_PACK:"599061016853145",SEARCH_PACK_ID:"680229632032514",OZ_PACK_ID:"1456625217993235",SPRITE_PADDING:"24",PayloadSource:{VIEW_ACTION:"view-action"},EMOTICON_PACK_ID:"1471127876485636",DEFAULT_FRAME_RATE:83,TRAY_SIZE:64,THREAD_SIZE:120};}),

null);

/** __static_js_modules__/storyattachmentstyle.js */




__d("StoryAttachmentStyle",[],(function a(b,c,d,e,f,g){

f.exports={FALLBACK:"fallback",SHARE:"share",OG_COMPOSER_SIMPLE:"og_composer_simple",SPORTS_MATCHUP:"sports_matchup",SHARE_LARGE_IMAGE:"share_large_image",PHOTO:"photo",COVER_PHOTO:"cover_photo",INSPIRATION_PHOTO:"inspiration_photo",ALBUM:"album",NEW_ALBUM:"new_album",COUPON:"coupon",QUESTION:"question",ANSWER:"answer",OPTION:"option",GALLERY:"gallery",STREAM_PUBLISH:"stream_publish",MUSIC_AGGREGATION:"music_aggregation",ITEM_LIST:"list",HIGH_SCORE:"high_score",SCORE_LEADERBOARD:"score_leaderboard",FRIEND_LIST:"friend_list",POPULAR_OBJECTS:"popular_objects",AVATAR_LIST:"avatar_list",AVATAR:"avatar",AVATAR_WITH_VIDEO:"avatar_with_video",EVENT:"event",CANCELED_EVENT:"canceled_event",MINUTIAE_EVENT:"minutiae_event",EXPERIENCE:"experience",LIFE_EVENT:"life_event",GIFT:"gift",IMAGE_SHARE:"image_share",ANIMATED_IMAGE_SHARE:"animated_image_share",ANIMATED_IMAGE_AUTOPLAY:"animated_image_autoplay",ANIMATED_IMAGE_VIDEO:"animated_image_video",ANIMATED_IMAGE_VIDEO_AUTOPLAY:"animated_image_video_autoplay",NOTE:"note",TOPIC:"topic",TOPIC_FOLLOWING_TOPIC:"topic_following_topic",FILE_UPLOAD:"file_upload",NOTIFICATION_TARGET:"notification_target",UNAVAILABLE:"unavailable",PAGE_RECOMMENDATION:"page_recommendation",PAGE_VIDEO_PLAYLIST:"page_video_playlist",VIDEO:"video",VIDEO_INLINE:"video_inline",VIDEO_AUTOPLAY:"video_autoplay",VIDEO_SHARE:"video_share",VIDEO_SHARE_HIGHLIGHTED:"video_share_highlighted",VIDEO_SHARE_YOUTUBE:"video_share_youtube",VIDEO_DIRECT_RESPONSE:"video_direct_response",VIDEO_DIRECT_RESPONSE_AUTOPLAY:"video_direct_response_autoplay",VIDEO_SHOP:"video_shop",INSPIRATION_VIDEO:"inspiration_video",MULTI_VIDEOS_STITCHED:"multi_videos_stitched",MAP:"map",OG_MAP:"og_map",PRODUCT:"product",EXTERNAL_PRODUCT:"external_product",FITNESS_COURSE:"fitness_course",APPLICATION:"application",STICKER:"sticker",EXTERNAL_OG_PRODUCT:"external_og_product",TRAVEL_LOG:"travel_log",MULTI_SHARE:"multi_share",MULTI_SHARE_NO_END_CARD:"multi_share_no_end_card",MULTI_SHARE_NON_LINK_VIDEO:"multi_share_non_link_video",MULTI_SHARE_SEARCH_END_CARD:"multi_share_search_end_card",MULTI_SHARE_FIXED_TEXT:"multi_share_fixed_text",YEAR_IN_REVIEW:"year_in_review",AVATAR_LARGE_COVER:"avatar_large_cover",COMMERCE_PRODUCT_ITEM:"commerce_product_item",COMMERCE_STORE:"commerce_store",THIRD_PARTY_PHOTO:"third_party_photo",PROMPT:"prompt",BIRTHDAY:"birthday",DISCUSSION_CONVERSATION:"discussion_conversation",DISCUSSION_COMMENT:"discussion_comment",GROUP_SELL_PRODUCT_ITEM:"group_sell_product_item",GROUP_SELL_PRODUCT_ITEM_MARK_AS_SOLD:"group_sell_mark_as_sold",GAMETIME:"gametime",GAMETIME_LEAGUE:"gametime_league",GAMETIME_PLAY:"gametime_play",GROUP_REPORTED_POST_QUEUE:"group_reported_post_queue",GROUP_PENDING_POST_QUEUE:"group_pending_post_queue",GROUP_JOIN_REQUEST_QUEUE:"group_join_request_queue",GREETING_CARD:"greeting_card",LEAD_GEN:"lead_gen",ATTACHED_STORY:"attached_story",POST_CHANNEL:"post_channel",TEXT_FOR_COLLAGE:"text_for_collage",SOUVENIR:"souvenir",SLIDESHOW:"slideshow",ORION:"orion",ORION_REQUEST:"orion_request",P2P_PAYMENT:"p2p_payment",INSTANT_ARTICLE:"instant_article",MOMENTS_APP_INVITATION:"moments_app_invitation",MOMENTS_APP_PHOTO_REQUEST:"moments_app_photo_request",RIDE_ORDERED:"ride_ordered",RIDE_RECEIPT:"ride_receipt",BUSINESS_MESSAGE_ITEMS:"business_message_items",RETAIL_CANCELLATION:"retail_cancellation",RETAIL_PROMOTION:"retail_promotion",RETAIL_ITEM:"retail_item",RETAIL_NOW_IN_STOCK:"retail_now_in_stock",RETAIL_RECEIPT:"retail_receipt",RETAIL_SHIPMENT:"retail_shipment",RETAIL_SHIPMENT_FOR_SUPPORTED_CARRIER:"retail_shipment_for_supported_carrier",RETAIL_SHIPMENT_FOR_UNSUPPORTED_CARRIER:"retail_shipment_for_unsupported_carrier",RETAIL_SHIPMENT_TRACKING_EVENT:"retail_shipment_tracking_event",RETAIL_SHIPMENT_TRACKING_EVENT_ETA:"retail_shipment_tracking_event_eta",RETAIL_SHIPMENT_TRACKING_EVENT_IN_TRANSIT:"retail_shipment_tracking_event_in_transit",RETAIL_SHIPMENT_TRACKING_EVENT_OUT_FOR_DELIVERY:"retail_shipment_tracking_event_out_for_delivery",RETAIL_SHIPMENT_TRACKING_EVENT_DELAYED:"retail_shipment_tracking_event_delayed",RETAIL_SHIPMENT_TRACKING_EVENT_DELIVERED:"retail_shipment_tracking_event_delivered",SURVEY:"survey",MESSAGE_LOCATION:"message_location",JOB_OFFER:"job_offer",GROUP_ADD_MEMBERS:"group_add_memebers",GROUP_MEMBER_ADDED:"group_member_added",RTC_CALL_LOG:"rtc_call_log",EVENTS_PENDING_POST_QUEUE:"events_pending_post_queue",EVENT_CALENDAR:"event_calendar",FACEPILE:"facepile",ATTRIBUTED_SHARE:"attributed_share",VIDEO_CINEMAGRAPH:"video_cinemagraph",LOCAL_CONTEXT_SHARE:"local_context_share",H_SCROLL:"h_scroll",EGO_HSCROLL:"ego_hscroll",MEDIA_QUESTION:"media_question",RICH_MEDIA:"rich_media",RICH_MEDIA_COLLECTION:"rich_media_collection",SQUARE_IMAGE_SHARE:"square_image_share",RETAIL_AGENT_ITEM_SUGGESTION:"retail_agent_item_suggestion",RETAIL_AGENT_ITEM_RECEIPT:"retail_agent_item_receipt",NOTE_COMPOSED:"note_composed",AVATAR_WITH_BIRTHDAY:"avatar_with_birthday",AIRLINE_FLIGHT_RESCHEDULE_UPDATE_BUBBLE:"airline_flight_reschedule_update_bubble",AIRLINE_CONFIRMATION:"airline_confirmation",AIRLINE_CHECK_IN:"airline_check_in",AIRLINE_BOARDING_PASS:"airline_boarding_pass",AIRLINE_FLIGHT_RESCHEDULE_UPDATE:"airline_flight_reschedule_update",LIGHTBOX_VIDEO:"lightbox_video",GLOBALLY_DELETED_MESSAGE_PLACEHOLDER:"globally_deleted_message_placeholder",GENIE_MESSAGE:"genie_message",MOVIE_BOT_MOVIE_LIST:"movie_bot_movie_list",MOVIE_BOT_MOVIE_SHOWTIME_LIST:"movie_bot_movie_showtime_list",AVATAR_WITH_EGO_ACTION:"avatar_with_ego_action",EVENT_TICKET_DEPRECATED:"event_ticket",VERTICAL_ATTACHMENT_LIST:"vertical_attachment_list",INSTANT_ARTICLE_LEGACY:"instant_article_legacy",FUNDRAISER_PAGE:"fundraiser_page",FINANCIAL_BILL_PAYMENT_REQUEST:"financial_bill_payment_request",GOODWILL_THROWBACK_FRIENDVERSARY_POLAROIDS_CARD:"goodwill_throwback_friendversary_polaroids_card",WELCOME_CARD_IMAGE:"welcome_card_image",LARGE_IMAGE_LIKE:"large_image_like",ASK_FRIENDS:"ask_friends",CULTURAL_MOMENT:"cultural_moment",TELEPHONE_CALL_LOG:"telephone_call_log",SUPER_EMOJI:"super_emoji",BOOK:"book",SUBTOPIC_CUSTOMIZATION_QUESTION:"subtopic_customization_question",SUBTOPIC_CUSTOMIZATION_OPTION:"subtopic_customization_option",RESTAURANT:"restaurant",CONNECTION_QUESTION:"connection_question",CONNECTION_QUESTION_OPTION:"connection_question_option",PYMI_ITEM:"pymi_item",GOODWILL_THROWBACK_FRIENDVERSARY_COLLAGE_CARD:"goodwill_throwback_friendversary_collage_card",CITY:"city",AVATAR_WITH_SHARE:"avatar_with_share",LIGHTWEIGHT_PLACE:"lightweight_place",QUOTED_SHARE:"quoted_share",SMS_LOG:"sms_log",CENTERED_TEXT:"centered_text",GOODWILL_THROWBACK_FRIENDVERSARY_DATA_CARD:"goodwill_throwback_friendversary_data_card",GOODWILL_THROWBACK_FACEVERSARY_COLLAGE_CARD:"goodwill_throwback_faceversary_collage_card",GOODWILL_THROWBACK_ANNIVERSARY_COLLAGE_CARD:"goodwill_throwback_anniversary_collage_card",MESSAGE_EVENT:"message_event",MESSAGE_THREAD:"message_thread",QUOTE:"quote",VOTER_REGISTRATION_SHARE:"voter_registration_share",AIRLINE_ITINERARY:"airline_itinerary",AIRLINE_UPDATE:"airline_update",PLACE_LIST:"place_list",IMPLICIT_PLACE_LIST_CONVERSION:"implicit_place_list_conversion",AIRLINE_CHECKIN_REMINDER:"airline_checkin_reminder",MINUTIAE_UNIT:"minutiae_unit",INSTANT_ARTICLE_PHOTO:"instant_article_photo",INSTANT_ARTICLE_VIDEO:"instant_article_video",PHOTO_LINK_SHARE:"photo_link_share",BUSINESS_LOCATION:"business_location",GOODWILL_WEATHER:"goodwill_weather",CULTURAL_MOMENT_HOLIDAY_CARD:"cultural_moment_holiday_card",TRANSACTION_INVOICE:"transaction_invoice",GROUP:"group",COMMENT_PLACE_INFO:"comment_place_info",GOODWILL_THROWBACK_FRIENDVERSARY_POLAROIDS_CARD_IPB:"goodwill_throwback_friendversary_polaroids_card_ipb",GOODWILL_THROWBACK_FRIENDVERSARY_COLLAGE_CARD_IPB:"goodwill_throwback_friendversary_collage_card_ipb",FUNDRAISER_PERSON_TO_CHARITY:"fundraiser_person_to_charity",FUNDRAISER_PERSON_FOR_PERSON:"fundraiser_person_for_person",FUNDRAISER_FOR_STORY:"fundraiser_for_story",MESSAGE_LIVE_LOCATION:"message_live_location",MESSENGER_INVITE:"messenger_invite",GAMES_INSTANT_PLAY:"games_instant_play",PROFILE_MEDIA:"profile_media",NATIVE_TEMPLATES:"native_templates",GOODWILL_THROWBACK_VIDEO_BASIC:"goodwill_throwback_video_basic",COMMERCE_PRODUCT_MINI:"commerce_product_mini",COMMERCE_PRODUCT_MINI_LIST:"commerce_product_mini_list",COMMENT:"comment",MESSENGER_TEAM_BOT_SHARE:"messenger_team_bot_share",LIVE_VIDEO_SCHEDULE:"live_video_schedule",PRODUCT_ITEM:"product_item",PLATFORM_INSTANT_APP:"platform_instant_app",YEAR_OVERVIEW:"year_overview",NATIVE_COMPONENT_FLOW_BOOKING_REQUEST:"native_component_flow_booking_request",FRIEND_REQUEST:"friend_request",MESSENGER_GROUP_JOINABLE_LINK:"messenger_group_joinable_link",SOCIAL_SEARCH_CONVERSION_PROMPT:"social_search_conversion_prompt",MDOTME_USER_LINK:"mdotme_user_link",DYNAMIC_MULTI_SHARE_ITEMS:"dynamic_multi_share_items",EVENT_REMINDER:"event_reminder",INSTANT_GAMES_SHARE_MESSAGE:"instant_games_share_message",MESSENGER_PLATFORM_COMPACT_ITEM:"messenger_platform_compact_item",MESSENGER_PLATFORM_COVER_ITEM:"messenger_platform_cover_item",MULTI_SHARE_NON_LINK_VIDEO_AUTO_SCROLL:"multi_share_non_link_video_auto_scroll",ENDORSEMENT:"endorsement",OFFER_VIEW_LIVE_COUNTDOWN:"offer_view_live_countdown",ENHANCED_LINK_REDDIT_POST:"enhanced_link_reddit_post",MESSENGER_COMMERCE_COVER_ITEM:"messenger_commerce_cover_item",ENHANCED_LINK_YELP_BUSINESS:"enhanced_link_yelp_business",PAGES_PLATFORM_LEAD_GEN:"pages_platform_lead_gen",NATIVE_STORY:"native_story",MFS_BILL_PAY_CREATION_UPDATE:"mfs_bill_pay_creation_update",MFS_BILL_PAY_REFERENCE_CODE_UPDATE:"mfs_bill_pay_reference_code_update",MFS_BILL_PAY_AGENT_CASH_IN_UPDATE:"mfs_bill_pay_agent_cash_in_update",ISSUE_POSITION:"issue_position",PAGES_PLATFORM_BOOKING_MESSAGE:"pages_platform_booking_message",EXTERNAL_GALLERY:"external_gallery",MEME_SHARE:"meme_share",MESSENGER_PLATFORM_ELEMENT:"messenger_platform_element",INSTANT_GAMES_SHARE_SCORE_MESSAGE:"instant_games_share_score_message",MESSENGER_PLATFORM_BUTTON_LIST:"messenger_platform_button_list",BALLOT:"ballot",LIGHTWEIGHT_ACTION:"lightweight_action",TAROT_DIGEST:"tarot_digest",EVENT_TOUR:"event_tour",ADAPTIVE_MEDIA:"adaptive_media",DYNAMIC_GAME_BOARD:"dynamic_game_board",PAYMENT_PLATFORM:"payment_platform",OMNI_M_FLOW:"omni_m_flow",GROUP_QUIZ:"group_quiz",TRIAL_AD:"trial_ad",TEEM_COLLECTIONS:"teem_collections",CRISIS_STATUS:"crisis_status",CRISIS_LISTING:"crisis_listing",VR_CONTENT:"vr_content",VIDEO_RECOMMENDATION_HSCROLL:"video_recommendation_hscroll",VIDEO_TRAILER:"video_trailer",SHOW_PAGE_SHARE:"show_page_share",MFS_ATTACHMENT:"mfs_attachment",GROUP_TASK:"group_task",VIDEO_RECOMMENDATION_SINGLETON:"video_recommendation_singleton",PAGE_REVIEW_PROMPT:"page_review_prompt",VIDEO_SHOW:"video_show",UNCONNECTED_VIDEO:"unconnected_video",SHOW_SHARE:"show_share",JOB_SEARCH_JOB_APPLICATION:"job_search_job_application",PAGE_MESSENGER_ATTACHMENT:"page_messenger_attachment",CONTACT_YOUR_REP:"contact_your_rep",LOCATION_EXTENSION:"location_extension",PLACE_RECOMMENDATION:"place_recommendation",JOB_SEARCH_JOB_OPENING:"job_search_job_opening"};}),

null);

/** js/logging/generated/OmniMEventTypedLogger.js */





__d('OmniMEventTypedLogger',['Banzai','GeneratedLoggerUtils','nullthrows'],(function a(b,c,d,e,f,g){
'use strict';



















function h(){
this.clear();}
h.prototype.





log=function(){
c('GeneratedLoggerUtils').log('logger:OmniMEventLoggerConfig',this.$OmniMEventTypedLogger_data,c('Banzai').BASIC);};
h.prototype.







logVital=function(){
c('GeneratedLoggerUtils').log('logger:OmniMEventLoggerConfig',this.$OmniMEventTypedLogger_data,c('Banzai').VITAL);};
h.prototype.




clear=function(){
this.$OmniMEventTypedLogger_data={};
return this;};
h.prototype.






updateData=function(j){








this.$OmniMEventTypedLogger_data=babelHelpers['extends']({},
this.$OmniMEventTypedLogger_data,
j);

return this;};
h.prototype.




setActionID=function(j){
this.$OmniMEventTypedLogger_data.action_id=j;
return this;};
h.prototype.




setActionTypeFromBlob=function(j){
this.$OmniMEventTypedLogger_data.action_type_from_blob=j;
return this;};
h.prototype.




setAgentName=function(j){
this.$OmniMEventTypedLogger_data.agent_name=j;
return this;};
h.prototype.




setAppID=function(j){
this.$OmniMEventTypedLogger_data.appid=j;
return this;};
h.prototype.




setAppversion=function(j){
this.$OmniMEventTypedLogger_data.appversion=j;
return this;};
h.prototype.





setClientUserID=function(j){
this.$OmniMEventTypedLogger_data.client_userid=j;
return this;};
h.prototype.







setClienttime=function(j){
this.$OmniMEventTypedLogger_data.clienttime=j;
return this;};
h.prototype.




setConfidence=function(j){
this.$OmniMEventTypedLogger_data.confidence=j;
return this;};
h.prototype.




setConfidenceRemapped=function(j){
this.$OmniMEventTypedLogger_data.confidence_remapped=j;
return this;};
h.prototype.




setContextUserID=function(j){
this.$OmniMEventTypedLogger_data.context_user_id=j;
return this;};
h.prototype.




setCuApp=function(j){
this.$OmniMEventTypedLogger_data.cu_app=j;
return this;};
h.prototype.




setEventName=function(j){
this.$OmniMEventTypedLogger_data.event_name=j;
return this;};
h.prototype.




setIntentID=function(j){
this.$OmniMEventTypedLogger_data.intent_id=j;
return this;};
h.prototype.




setMessageID=function(j){
this.$OmniMEventTypedLogger_data.message_id=j;
return this;};
h.prototype.




setMessageLength=function(j){
this.$OmniMEventTypedLogger_data.message_length=j;
return this;};
h.prototype.




setName=function(j){
this.$OmniMEventTypedLogger_data.name=j;
return this;};
h.prototype.




setPersonalization=function(j){
this.$OmniMEventTypedLogger_data.personalization=j;
return this;};
h.prototype.




setPigeonID=function(j){
this.$OmniMEventTypedLogger_data.pigeon_id=j;
return this;};
h.prototype.




setPosition=function(j){
this.$OmniMEventTypedLogger_data.position=j;
return this;};
h.prototype.




setSource=function(j){
this.$OmniMEventTypedLogger_data.source=j;
return this;};
h.prototype.




setSuggestionData=function(j){
this.$OmniMEventTypedLogger_data.suggestion_data=c('GeneratedLoggerUtils').serializeMap(j);
return this;};
h.prototype.




setSuggestionIds=function(j){
this.$OmniMEventTypedLogger_data.suggestion_ids=c('GeneratedLoggerUtils').serializeVector(j);
return this;};
h.prototype.




setSuggestionMode=function(j){
this.$OmniMEventTypedLogger_data.suggestion_mode=j;
return this;};
h.prototype.




setSuggestionTitle=function(j){
this.$OmniMEventTypedLogger_data.suggestion_title=j;
return this;};
h.prototype.




setSuggestionType=function(j){
this.$OmniMEventTypedLogger_data.suggestion_type=j;
return this;};
h.prototype.




setThreadID=function(j){
this.$OmniMEventTypedLogger_data.thread_id=j;
return this;};
h.prototype.




setTotalSuggestions=function(j){
this.$OmniMEventTypedLogger_data.total_suggestions=j;
return this;};
h.prototype.




setVC=function(j){
this.$OmniMEventTypedLogger_data.vc=j;
return this;};

























































































var i=
{action_id:true,
action_type_from_blob:true,
agent_name:true,
appid:true,
appversion:true,
client_userid:true,
clienttime:true,
confidence:true,
confidence_remapped:true,
context_user_id:true,
cu_app:true,
event_name:true,
intent_id:true,
message_id:true,
message_length:true,
name:true,
personalization:true,
pigeon_id:true,
position:true,
source:true,
suggestion_data:true,
suggestion_ids:true,
suggestion_mode:true,
suggestion_title:true,
suggestion_type:true,
thread_id:true,
total_suggestions:true,
vc:true};


f.exports=h;}),null);

/** shared/mercury/singleton/MercurySingletonProvider.js */









__d('MercurySingletonProvider',['CurrentUser'],(function a(b,c,d,e,f,g){

'use strict';










function h(i){
this.$MercurySingletonProvider_instances={};
this.$MercurySingletonProvider_model=i;}
h.prototype.

getForFBID=function(i){
if(!this.$MercurySingletonProvider_instances[i])
this.$MercurySingletonProvider_instances[i]=new this.$MercurySingletonProvider_model(i);

return this.$MercurySingletonProvider_instances[i];};
h.prototype.

get=function(){
return this.getForFBID(c('CurrentUser').getID());};
h.






mock=function(i){
throw new Error
('MercurySingletonProvider.mock() must only be used in tests.');};




f.exports=h;}),null);

/** js/mercury/utils/MercuryAssert.js */




__d('MercuryAssert',['MercuryIDs'],(function a(b,c,d,e,f,g){



f.exports=

{isParticipantID:function h(i){
if(!c('MercuryIDs').isValid(i))
throw new Error('bad_participant_id '+i);},



allParticipantIDs:function h(i){
i.forEach(this.isParticipantID);},


isUserParticipantID:function h(i){
var j=c('MercuryIDs').tokenize(i);

if(j.type!='fbid')
throw new Error('bad_user_id '+i);},



isEmailParticipantID:function h(i){
var j=c('MercuryIDs').tokenize(i);

if(j.type!='email')
throw new Error('bad_email_id '+i);},



allThreadID:function h(i){
i.forEach(this.isThreadID);},


isThreadID:function h(i){
if(!c('MercuryIDs').isValid(i))
throw new Error('bad_thread_id '+i);}};}),

null);

/** js/mercury/models/MercuryThreadInformer.js */












































__d('MercuryThreadInformer',['ArbiterMixin','LogHistory','MercuryAssert','MercurySingletonProvider','mapObject','mixin'],(function a(b,c,d,e,f,g){

'use strict';var h,i,









j=c('LogHistory').getInstance('mercury_informer');h=babelHelpers.inherits

(k,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;k.













get=function(){
return l.get();};
k.

getForFBID=function(m){
return l.getForFBID(m);};


function k(m){
i.constructor.call(this);
this.$MercuryThreadInformer_fbid=m;

this.$MercuryThreadInformer_threadDeletions={};
this.$MercuryThreadInformer_threadChanges={};
this.$MercuryThreadInformer_threadInvalidations={};
this.$MercuryThreadInformer_threadReadChanges={};
this.$MercuryThreadInformer_threadlistChanged=false;
this.$MercuryThreadInformer_unseenStateChanged=false;
this.$MercuryThreadInformer_unreadStateChanged=false;
this.$MercuryThreadInformer_receivedMessages={};
this.$MercuryThreadInformer_reorderedMessages={};
this.$MercuryThreadInformer_updatedMessages={};

this.$MercuryThreadInformer_locked=0;}
k.prototype.

updatedThread=function(m){
this.$MercuryThreadInformer_threadChanges[m]=true;
this.$MercuryThreadInformer_tryInform();};
k.prototype.

invalidatedThread=function(m){
this.$MercuryThreadInformer_threadInvalidations[m]=true;
this.$MercuryThreadInformer_tryInform();};
k.prototype.

deletedThread=function(m){
this.$MercuryThreadInformer_threadDeletions[m]=true;
this.$MercuryThreadInformer_tryInform();};
k.prototype.

updatedThreadlist=function(){
this.$MercuryThreadInformer_threadlistChanged=true;
this.$MercuryThreadInformer_tryInform();};
k.prototype.

updatedUnseenState=function(){
this.$MercuryThreadInformer_unseenStateChanged=true;
this.$MercuryThreadInformer_tryInform();};
k.prototype.

updatedUnreadState=function(){
this.$MercuryThreadInformer_unreadStateChanged=true;
this.$MercuryThreadInformer_tryInform();};
k.prototype.

changedThreadReadState=
function(m,
n,
o){

if(!this.$MercuryThreadInformer_threadReadChanges[m]||
this.$MercuryThreadInformer_threadReadChanges[m].timestamp<o)
this.$MercuryThreadInformer_threadReadChanges[m]=
{mark_as_read:n,
timestamp:o};



this.$MercuryThreadInformer_tryInform();};
k.prototype.

receivedMessage=function(m){
c('MercuryAssert').isThreadID(m.thread_id);

var n=m.thread_id;

if(!this.$MercuryThreadInformer_receivedMessages[n])
this.$MercuryThreadInformer_receivedMessages[n]=[];


this.$MercuryThreadInformer_receivedMessages[n].push(m);
this.updatedThread(n);};
k.prototype.

reorderedMessages=function(m,n){
this.$MercuryThreadInformer_reorderedMessages[m]={source:n};
this.$MercuryThreadInformer_tryInform();};
k.prototype.

updatedMessage=function(m,n,o){
if(!this.$MercuryThreadInformer_updatedMessages[m])
this.$MercuryThreadInformer_updatedMessages[m]={};


this.$MercuryThreadInformer_updatedMessages[m][n]={source:o};
this.updatedThread(m);};
k.prototype.

synchronizeInforms=function(m){
this.$MercuryThreadInformer_locked++;

try{m();}catch(
n){

throw n;}finally{

this.$MercuryThreadInformer_locked--;
this.$MercuryThreadInformer_tryInform();}};

k.prototype.

listen=function(m,n){
return this.subscribe
('threads-updated',
function(o,p){
if(p[m])
n(m);});};



k.prototype.

$MercuryThreadInformer_tryInform=function(){
if(!this.$MercuryThreadInformer_locked){
var m=this.$MercuryThreadInformer_threadDeletions,
n=this.$MercuryThreadInformer_threadChanges,
o=this.$MercuryThreadInformer_threadInvalidations,
p=this.$MercuryThreadInformer_threadReadChanges,
q=this.$MercuryThreadInformer_threadlistChanged,
r=this.$MercuryThreadInformer_unseenStateChanged,
s=this.$MercuryThreadInformer_unreadStateChanged,
t=this.$MercuryThreadInformer_receivedMessages,
u=this.$MercuryThreadInformer_reorderedMessages,
v=this.$MercuryThreadInformer_updatedMessages;

this.$MercuryThreadInformer_threadDeletions={};
this.$MercuryThreadInformer_threadChanges={};
this.$MercuryThreadInformer_threadInvalidations={};
this.$MercuryThreadInformer_threadReadChanges={};
this.$MercuryThreadInformer_threadlistChanged=false;
this.$MercuryThreadInformer_unseenStateChanged=false;
this.$MercuryThreadInformer_unreadStateChanged=false;
this.$MercuryThreadInformer_receivedMessages={};
this.$MercuryThreadInformer_reorderedMessages={};
this.$MercuryThreadInformer_updatedMessages={};

var w=Object.keys(n);
if(w.length||q)
this.inform('threadlist-updated',w);


if(w.length)

this.$MercuryThreadInformer_inform('threads-updated',n);


for(var x in o){
this.$MercuryThreadInformer_inform('thread-invalidated',o);
break;}


for(var x in p){
this.$MercuryThreadInformer_inform('thread-read-changed',p);
break;}


for(x in m){
this.$MercuryThreadInformer_inform('threads-deleted',m);
break;}


if(r)
this.$MercuryThreadInformer_inform('unseen-updated',null);


if(s)
this.$MercuryThreadInformer_inform('unread-updated',null);


for(x in t){
this.$MercuryThreadInformer_inform('messages-received',t);
break;}


for(x in u){
this.$MercuryThreadInformer_inform('messages-reordered',u);
break;}


for(x in v){
this.$MercuryThreadInformer_inform('messages-updated',v);
break;}}};


k.prototype.

$MercuryThreadInformer_inform=function(m,n){
j.debug
(m,
m==='threads-updated'?
JSON.stringify(n):
'{}');

this.inform(m,n);};



var l=new (c('MercurySingletonProvider'))(k);

f.exports=k;}),null);

/** js/mercury/clients/messenger/MessengerEnvironment.js */






__d('MessengerEnvironment',['CurrentEnvironment'],(function a(b,c,d,e,f,g){

'use strict';



var h=babelHelpers['extends']({},c('CurrentEnvironment'),

{messengerui:false,
setMessengerUI:function i(j){
this.messengerui=j;}});



f.exports=h;}),null);

/** js/mercury/models/MercuryMessageObject.js */






__d('MercuryMessageObject',['fbt','BanzaiODS','MercuryActionStatus','MercuryActionType','MercuryIDs','MercuryLocalIDs','MercuryMessageClientState','MercuryMessageSourceTags','MercurySingletonProvider','MercurySourceType','MercuryThreads','MercuryTimePassed','MercuryTimestamp','MercurySendMessageFields','formatDate'],(function a(b,c,d,e,f,g,h){i.























getForFBID=function(m){'use strict';
return l.getForFBID(m);};
i.

get=function(){'use strict';
return l.get();};


function i(m){'use strict';
this.$MercuryMessageObject_fbid=m;
this.$MercuryMessageObject_threads=c('MercuryThreads').getForFBID(m);}
i.prototype.














constructUserGeneratedMessageObject=
function(m,
n,
o,
p,
q){
'use strict';

var r=j
(this.$MercuryMessageObject_fbid,
c('MercuryActionType').USER_GENERATED_MESSAGE,
n,
o);



if(typeof m=='string')
m=m.replace(/^\s+/,'').replace(/\s+$/,'');


r.body=m;
r.has_attachment=false;
r.html_body=false;
r.attachments=[];
r.specific_to_list=p||[];
r.creator_info=q;

return r;};
i.prototype.






constructStickerMessageObject=
function(m,
n,
o){
'use strict';
var p=j
(this.$MercuryMessageObject_fbid,
c('MercuryActionType').USER_GENERATED_MESSAGE,
n,
o);


p.has_attachment=true;
p.html_body=false;
p.attachments=[];
p.sticker_id=m;
p.specific_to_list=[];

return p;};
i.prototype.





constructAttachmentMessageObject=
function(m,
n){
'use strict';
var o=j
(this.$MercuryMessageObject_fbid,
c('MercuryActionType').USER_GENERATED_MESSAGE,
m,
n);


o.attachments=[];
o.specific_to_list=[];

return o;};
i.prototype.











constructLogMessageObject=
function(m,
n,
o,
p){
'use strict';

var q=j
(this.$MercuryMessageObject_fbid,
c('MercuryActionType').LOG_MESSAGE,
m,
n);

q.log_message_type=o;
q.log_message_data=p;
if(p&&
p.untypedData&&
p.untypedData.ttl)
q.ephemeral_ttl_mode=p.untypedData.ttl;

return q;};
i.prototype.






constructCTAConfirmationMessageObject=
function(m,
n,
o,
p){

var q=arguments.length<=4||arguments[4]===undefined?null:arguments[4];'use strict';
var r=this.constructUserGeneratedMessageObject
(m,
n,
o,
null,
null),


s={};
if(p){
s=
{quick_replies:p,
ignore_for_webhook:false};}else 


s=
{ignore_for_webhook:true};


r.platform_xmd=JSON.stringify(s);
if(q&&q.length>0)
r.tags=q;

return r;};
i.prototype.







normalizeNewMessage=function(m){'use strict';

if(m.status===undefined)
m.status=c('MercuryActionStatus').UNSENT;



m.offline_threading_id=m.offline_threading_id||
c('MercuryLocalIDs').generateOfflineThreadingID(m.timestamp);
if(!m.offline_threading_id)
c('BanzaiODS').bumpEntityKey('chat.web','invalid_otid_generated');



m.message_id=m.message_id||m.offline_threading_id;

var n=c('MercuryIDs').getParticipantIDFromUserID(this.$MercuryMessageObject_fbid);

m.specific_to_list=m.specific_to_list||[];

if(m.specific_to_list.length&&
m.specific_to_list.indexOf(n)===-1)

m.specific_to_list.push(n);


if(!m.thread_id){

m.thread_id='root:'+m.offline_threading_id;}else{


var o=this.$MercuryMessageObject_threads.getThreadMetaNow(m.thread_id);
if(o&&
o.ephemeral_ttl_mode!==null&&
m.ephemeral_ttl_mode===undefined)
m.ephemeral_ttl_mode=o.ephemeral_ttl_mode;}




if(m.specific_to_list.length==1){


m.thread_id='user:'+this.$MercuryMessageObject_fbid;}else
if(m.specific_to_list.length==2){
var p=m.specific_to_list[0]==n?
m.specific_to_list[1]:
m.specific_to_list[0];

m.thread_id=c('MercuryIDs').getThreadIDFromParticipantID(p);}


if(!m.specific_to_list.length){var q=
c('MercuryIDs').tokenize(m.thread_id),r=q.type,s=q.value;
if(r=='user')



m.specific_to_list=
['fbid:'+s,
n];}





if(!m[c('MercurySendMessageFields').MANUAL_RETRY_CNT])
m[c('MercurySendMessageFields').MANUAL_RETRY_CNT]=0;};

i.prototype.






normalizeResendMessage=function(m){'use strict';
m.status=c('MercuryActionStatus').RESENDING;
m.timestamp=Date.now();
m[c('MercurySendMessageFields').MANUAL_RETRY_CNT]+=1;};
i.prototype.








normalizeAddAttachmentPlaceholder=
function(m,
n,
o){
'use strict';

if(o.preview_attachments.length>0){
m.has_attachment=true;
m.preview_attachments=o.preview_attachments;}





m.client_state=c('MercuryMessageClientState').DO_NOT_SEND_TO_SERVER;
m.status=c('MercuryActionStatus').RESENDING;
m.upload_id=n;};














function j
(m,
n,
o,
p){

var q=
k(o)?[c('MercuryMessageSourceTags').CHAT]:[],
r=Date.now(),
s=
{action_type:n,
thread_id:p,
author:c('MercuryIDs').getParticipantIDFromUserID(m),
author_email:null,
timestamp:r,
is_unread:false,
is_filtered_content:false,
is_filtered_content_bh:false,
is_filtered_content_account:false,
is_filtered_content_quasar:false,
is_filtered_content_invalid_app:false,
is_spoof_warning:false,
source:o,
source_tags:q};


return s;}





function k(m){
switch(m){
case c('MercurySourceType').CHAT_WEB:
case c('MercurySourceType').CHAT_JABBER:
case c('MercurySourceType').CHAT_IPHONE:
case c('MercurySourceType').CHAT_MEEBO:
case c('MercurySourceType').CHAT_ORCA:
case c('MercurySourceType').CHAT_TEST:
case c('MercurySourceType').CHAT:
return true;

default:return false;}}



var l=new (c('MercurySingletonProvider'))(i);

f.exports=i;}),null);

/** js/mercury/actions/MercuryMessageActions.js */





__d('MercuryMessageActions',['MercuryActionType','MercuryDispatcher','MercuryMessageObject','MercuryPayloadSource','MercuryServerRequests','MercurySingletonMixin'],(function a(b,c,d,e,f,g){

'use strict';









function h(i){
this.$MercuryMessageActions_fbid=i;
this.$MercuryMessageActions_messageObject=c('MercuryMessageObject').getForFBID(this.$MercuryMessageActions_fbid);
this.__serverRequests=c('MercuryServerRequests').getForFBID(this.$MercuryMessageActions_fbid);
this.__dispatcher=c('MercuryDispatcher').getForFBID(this.$MercuryMessageActions_fbid);}
h.prototype.








send=function(i,j,k){
j=j||Function.prototype;
this.$MercuryMessageActions_messageObject.normalizeNewMessage(i);

this.__dispatcher.handleUpdate
(this.__constructClientSingleMessagePayload(babelHelpers['extends']({},
i),
c('MercuryPayloadSource').CLIENT_SEND_MESSAGE));



this.__serverRequests.sendNewMessage(i,k);

j(i.thread_id);};
h.prototype.







resend=function(i,j){
var k=babelHelpers['extends']({},i);
this.$MercuryMessageActions_messageObject.normalizeResendMessage(k);
this.send(k,undefined,j);};
h.prototype.










addAttachmentPlaceholder=function(i,j,k){
this.$MercuryMessageActions_messageObject.normalizeAddAttachmentPlaceholder
(i,
j,
k);

this.$MercuryMessageActions_messageObject.normalizeNewMessage(i);

this.__dispatcher.handleUpdate
(this.__constructClientSingleMessagePayload(babelHelpers['extends']({},
i),
c('MercuryPayloadSource').CLIENT_SEND_MESSAGE));};


h.prototype.







cancelAttachmentPlaceholder=function(i,j){
this.__dispatcher.handleUpdate
(this.__constructClientSingleMessagePayload

({upload_id:i,
upload_data:j,
action_type:c('MercuryActionType').CANCEL_ATTACHMENT_PLACEHOLDER},

c('MercuryPayloadSource').CLIENT_SEND_MESSAGE));};


h.prototype.








confirmAttachmentPlaceholder=function(i,j){
this.__dispatcher.handleUpdate
(this.__constructClientSingleMessagePayload

({upload_id:i,
upload_data:j,
action_type:
c('MercuryActionType').CONFIRM_ATTACHMENT_PLACEHOLDER},

c('MercuryPayloadSource').CLIENT_SEND_MESSAGE));};


h.prototype['delete']=










function(i,j,k){
this.__dispatcher.handleUpdate
(this.$MercuryMessageActions_constructClientMultipleMessagesPayload
(i,
j,
c('MercuryActionType').DELETE_MESSAGES,
k||c('MercuryPayloadSource').CLIENT_DELETE_MESSAGES));};


h.prototype.

unwrap=function(i){
this.__dispatcher.handleUpdate
(this.__constructClientSingleMessagePayload

({thread_id:i.thread_id,
unwrapped_message_id:i.message_id,
action_type:
c('MercuryActionType').UNWRAP_MESSAGE},

c('MercuryPayloadSource').CLIENT_UNWRAP_MESSAGE));};


h.prototype.








__constructClientSingleMessagePayload=
function(i,
j){


return {actions:[i],
from_client:true,
payload_source:j};};

h.prototype.








$MercuryMessageActions_constructServerSingleMessagePayload=
function(i,
j){


return {actions:[i],
from_client:false,
payload_source:j};};

h.prototype.










$MercuryMessageActions_constructClientMultipleMessagesPayload=
function(i,
j,
k,
l){


return {actions:
[{action_type:k,
thread_id:i,
message_ids:j}],

from_client:true,
payload_source:l};};




Object.assign(h,c('MercurySingletonMixin'));

f.exports=h;}),null);

/** js/mercury/clients/chat/ChatBehavior.js */






__d('ChatBehavior',['Arbiter','AvailableList','AvailableListConstants','ChatNotificationConstants'],(function a(b,c,d,e,f,g){






var h=false,

i=c('AvailableList').getWebChatNotification&&
c('AvailableList').getWebChatNotification(),
j=h,
k=true,

l=Object.assign(new (c('Arbiter'))(),
{ON_CHANGED:'changed',





notifiesUserMessages:function n(){
return i!==c('ChatNotificationConstants').NO_USER_MESSAGE_NOTIFICATION;},







ignoresRemoteTabRaise:function n(){
return j;},






showsTabUnreadUI:function n(){
return k;}});



function m(){
l.inform(l.ON_CHANGED);}


c('AvailableList').subscribe&&
c('AvailableList').subscribe
(c('AvailableListConstants').ON_CHAT_NOTIFICATION_CHANGED,
function(){
var n=i,
o=c('AvailableList').getWebChatNotification();
i=o;
if(n!=o)
m();});




c('Arbiter').subscribe
('chat/set_does_page_occlude_tabs',
function(n,o){
j=!!o;
m();});



c('Arbiter').subscribe
('chat/set_show_tab_unread_ui',
function(n,o){
k=!!o;
m();});



f.exports=l;}),null);

/** js/mercury/clients/messenger/components/messenger_commerce/MNCommerceDialogContainer.react.js */







__d('MNCommerceDialogContainer.react',['MNCommerceDialogStateStore','PureStoreBasedStateMixin','React'],(function a(b,c,d,e,f,g){

'use strict';





var h=c('React').createClass({displayName:'MNCommerceDialogContainer',

mixins:
[c('PureStoreBasedStateMixin')(c('MNCommerceDialogStateStore'))],




statics:
{calculateState:function i(){
var j=c('MNCommerceDialogStateStore').getDialogContainer();
return {dialogContainer:j};}},



render:function i(){
var j=this.state.dialogContainer;
if(!j)
return null;

return c('React').createElement(j,null);}});



f.exports=h;}),null);

/** js/mercury/clients/messenger/components/omnim/OmniMActions.js */






__d('OmniMActions',['MessengerFluxReduceDispatcher','keyMirror','setImmediate'],(function a(b,c,d,e,f,g){

'use strict';






var h=c('keyMirror')
({BAR_DISMISSED:null,
BAR_DISPLAYED:null,
BAR_DISAPPEARED:null,
BAR_TIMED_OUT:null,
MERCURY_DISPATCHED:null,
FETCH_SUGGESTIONS:null,
PREFS_UPDATED:null,
SUGGESTION_CLICKED:null,
SUGGESTION_COMPLETED:null,
SUGGESTION_DISMISSED:null,
SUGGESTION_DISPLAYED:null,
SUGGESTION_DISAPPEARED:null,
SUGGESTION_MODE_SET:null,
SUGGESTIONS_DISMISSED_FOR_THREAD:null}),


i='omnim',

j=
{Types:h,
Namespace:i,

mercuryDispatched:function k(l,m){
c('MessengerFluxReduceDispatcher').dispatch
({type:h.MERCURY_DISPATCHED,
namespace:i,
mercuryType:l,
data:m});},



messageFetched:function k(l,m){
c('setImmediate')(function(){
c('MessengerFluxReduceDispatcher').dispatch
({type:h.FETCH_SUGGESTIONS,
namespace:i,
threadID:l,
message:m});});},




suggestionClicked:function k(l,m,n,o){
c('MessengerFluxReduceDispatcher').dispatch
({type:h.SUGGESTION_CLICKED,
namespace:i,
threadID:l,
option:m,
source:n,
position:o});},



suggestionCompleted:function k
(l,
m,
n,
o){

c('MessengerFluxReduceDispatcher').dispatch
({type:h.SUGGESTION_COMPLETED,
namespace:i,
threadID:l,
option:m,
source:n,
position:o});},



suggestionDismissed:function k
(l,
m,
n,
o){

c('MessengerFluxReduceDispatcher').dispatch
({type:h.SUGGESTION_DISMISSED,
namespace:i,
threadID:l,
option:m,
source:n,
position:o});},



suggestionsDismissedForThread:function k(l){
c('MessengerFluxReduceDispatcher').dispatch
({type:h.SUGGESTIONS_DISMISSED_FOR_THREAD,
namespace:i,
threadID:l});},



suggestionDisplayed:function k(l,m){

c('setImmediate')(function(){
c('MessengerFluxReduceDispatcher').dispatch
({type:h.SUGGESTION_DISPLAYED,
namespace:i,
option:l,
position:m});});},




suggestionDisappeared:function k(l,m){

c('setImmediate')(function(){
c('MessengerFluxReduceDispatcher').dispatch
({type:h.SUGGESTION_DISAPPEARED,
namespace:i,
option:l,
position:m});});},




prefsUpdated:function k(l){
c('MessengerFluxReduceDispatcher').dispatch
({type:h.PREFS_UPDATED,
namespace:i,
prefs:l});},



suggestionModeSet:function k(l){
c('MessengerFluxReduceDispatcher').dispatch
({type:h.SUGGESTION_MODE_SET,
namespace:i,
mode:l});},



barDismissed:function k(l){
c('MessengerFluxReduceDispatcher').dispatch
({type:h.BAR_DISMISSED,
namespace:i,
options:l});},



barDisplayed:function k(l){

c('setImmediate')(function(){
c('MessengerFluxReduceDispatcher').dispatch
({type:h.BAR_DISPLAYED,
namespace:i,
options:l});});},




barDisappeared:function k(l){

c('setImmediate')(function(){
c('MessengerFluxReduceDispatcher').dispatch
({type:h.BAR_DISAPPEARED,
namespace:i,
options:l});});},




barTimedOut:function k(l,m){

c('setImmediate')(function(){
c('MessengerFluxReduceDispatcher').dispatch
({type:h.BAR_TIMED_OUT,
namespace:i,
options:m,
threadID:l});});}};





f.exports=j;}),null);

/** js/mercury/clients/messenger/components/omnim/OmniMHelpers.js */






__d('OmniMHelpers',['immutable','MercuryConfig'],(function a(b,c,d,e,f,g){




function h
(i){


if(!c('MercuryConfig').OmniMEditConfidenceThreshold)
return 0;

if(i&&i.has('suggestion_mode')){

var j=i.get('suggestion_mode');
return j!==null&&j!==undefined?j:1;}


return 3;}


f.exports=
{suggestionMode:h};}),null);

/** js/mercury/clients/messenger/constants/omnim/MNOmniMConstants.js */






__d('MNOmniMConstants',['keyMirror'],(function a(b,c,d,e,f,g){

'use strict';



var h=c('keyMirror')
({OMNIM:null,
QUICKREPLIES:null});



h.SUGGESTION_MODES=
['conservative',
'balanced',
'aggressive',
'muted'];


f.exports=h;}),null);

/** js/mercury/clients/messenger/components/omnim/OmniMLogHelpers.js */






__d('OmniMLogHelpers',['OmniMEventTypedLogger','MNOmniMConstants','OmniMLoggerEvents','CurrentUser'],(function a(b,c,d,e,f,g){








function h(s){


return c('MNOmniMConstants').SUGGESTION_MODES[s];}


function i
(s,
t,
u,
v){

new (c('OmniMEventTypedLogger'))().
setEventName(s).
setPosition(u+'').
setMessageID(t.messageID).
setPigeonID(t.suggestionID).
setSuggestionMode(h(v)).
setContextUserID(c('CurrentUser').getID()).

setConfidence(Math.round(t.confidence*10000)).
log();}


function j
(s,

t,
u){

new (c('OmniMEventTypedLogger'))().
setEventName(s).
setSuggestionMode(h(u)).
setContextUserID(c('CurrentUser').getID()).
setSuggestionIds(t.map(function(v){return v.suggestionID;})).
log();}


function k(s,t,u){
i(c('OmniMLoggerEvents').SUGGESTION_DISPLAYED,s,t,u);}


function l(s,t,u){
i(c('OmniMLoggerEvents').SUGGESTION_DISAPPEARED,s,t,u);}


function m(s,t,u){
i(c('OmniMLoggerEvents').SUGGESTION_DISMISSED,s,t,u);}


function n(s,t,u){
i(c('OmniMLoggerEvents').SUGGESTION_CLICKED,s,t,u);}


function o(s,t,u){
i(c('OmniMLoggerEvents').SUGGESTION_COMPLETED,s,t,u);}


function p(s,t){
j(c('OmniMLoggerEvents').BAR_DISAPPEARED,s,t);}


function q(s,t){
j(c('OmniMLoggerEvents').BAR_DISMISSED,s,t);}


function r(s,t){
j(c('OmniMLoggerEvents').BAR_DISPLAYED,s,t);}


f.exports=
{barDisappeared:p,
barDisplayed:r,
barDismissed:q,
suggestionDisplayed:k,
suggestionDisappeared:l,
suggestionDismissed:m,
suggestionClicked:n,
suggestionCompleted:o};}),null);

/** www/__virtual__/x/XMessagingOmniMSetPrefController.js */



__d("XMessagingOmniMSetPrefController",["XController"],(function a(b,c,d,e,f,g){
f.exports=c("XController").create("\/messaging\/set_omnim_prefs\/",{});}),

null);

/** js/mercury/clients/messenger/components/omnim/OmniMReducer.js */






__d('OmniMReducer',['AsyncRequest','immutable','MercuryActionType','MercuryConfig','MercuryIDs','MercuryPayloadSource','MNOmniMConstants','OmniMActions','OmniMActionType','OmniMDirectiveType','OmniMLogHelpers','P2PGKValues','XMessagingOmniMSetPrefController'],(function a(b,c,d,e,f,g){

'use strict';var h,















i=c('OmniMActions').Types,








j=c('immutable').Set
([c('MercuryActionType').SEND_MESSAGE,
c('MercuryActionType').REPLACE_MESSAGE,
c('MercuryActionType').USER_GENERATED_MESSAGE]),


k=c('immutable').Set
([c('MercuryActionType').SEND_MESSAGE,
c('MercuryActionType').USER_GENERATED_MESSAGE]),


l=2;

function m(oa,pa){
switch(oa.content_type){
case 'text':
return true;
case 'location':
if(pa===c('MNOmniMConstants').OMNIM)
return c('MercuryConfig').OmniMLocationSuggestion;

return c('MercuryConfig').MessengerLocationQuickReply;
case 'sticker':
return c('MercuryConfig').MessengerStickerQuickReply;
case 'ride_service':
return c('MercuryConfig').MessengerRideServiceQuickReply;
case 'p2p_payment':
return c('P2PGKValues').P2PVisible&&
c('MercuryConfig').MessengerP2PPaymentQuickReply;

default:return false;}}







function n(oa){
return Array.isArray(oa);}


function o(oa){
if(!oa)
return {};

var pa=JSON.parse(oa)||{},
qa=n(pa.quick_replies)?pa.quick_replies:[],
ra=pa.m_directives;
return {quickReplies:qa,directives:ra};}


function p(oa){
var pa=oa.other_user_fbid,qa=oa.thread_fbid;
return pa?
c('MercuryIDs').getThreadIDFromUserID(pa):
c('MercuryIDs').getThreadIDFromThreadFBID(qa);}


var q=c('immutable').Map((h={},h[
c('OmniMActionType').CREATE_EVENT]='create_event',h[
c('OmniMActionType').LOCATION]='location',h[
c('OmniMActionType').PAYMENT]='p2p_payment',h[
c('OmniMActionType').POLL]='poll',h[
c('OmniMActionType').STICKER]='sticker',h[
c('OmniMActionType').TEXT]='text',h[
c('OmniMActionType').TRANSPORTATION]='ride_service',h[
c('OmniMActionType').ORDER_FOOD]='order_food',h[
c('OmniMActionType').MAKE_RESERVATION]='make_reservation',h[
c('OmniMActionType').SCHEDULE_CALL]='schedule_call',h[
c('OmniMActionType').LIVE_LOCATION]='live_location',h));


function r(oa){

var pa=







oa.confidence,qa=oa.id,ra=oa.label,sa=oa.type,ta=oa.data,ua=oa.icon,va=oa.message_id,wa=oa.thread_key;


return {content_type:q.get(sa+''),
data:ta,
image_url:ua,
title:ra,
confidence:pa,
messageID:va,
suggestionID:qa,
threadID:p(wa),
messageDepth:1};}



function s
(oa,
pa){

var qa=o(pa),

ra=(qa.quickReplies||[]).
filter(function(ta){return m(ta,c('MNOmniMConstants').QUICKREPLIES);}),

sa=(qa.directives||[]).
filter(function(ta){return ta.type===c('OmniMDirectiveType').ADD_ACTIONS;}).
map(function(ta){return ta.data.actions;}).

reduce(function(ta,ua){return ta.concat(ua);},[]).
map(r).
filter(function(ta){return m(ta,c('MNOmniMConstants').OMNIM);}).

reduce
(function(ta,ua){
var va=ua.threadID;
return ta.updateIn([va,'agentSuggestions'],[],function(wa){return wa.concat([ua]);});},

c('immutable').Map({}));


return sa.setIn([oa,'quickReplies'],ra);}


function t(oa){
var pa=oa.content_type;
Object.keys(oa.data||{}).sort().map(function(qa){
pa+=''+qa+oa.data[qa];});

return pa;}



function u(oa){
var pa=c('immutable').Set(),
qa=[];

for(var ra=oa.length-1;ra>=0;ra--){
var sa=oa[ra],
ta=t(sa);
if(!pa.has(ta)){
pa=pa.add(ta);
qa.unshift(sa);}}


return qa;}



function v
(oa){

var pa=0;
return oa.filter(function(qa){
if(qa.content_type==='sticker'){
if(pa>=l)
return false;

pa+=1;}

return true;});}



function w
(oa,
pa,
qa,
ra){

var sa=oa.getIn(['threadMetadata',pa,'timestamp']);
if(sa&&sa>ra)
return oa;


var ta=qa.agentSuggestions,ua=qa.quickReplies,
va=
(oa.getIn(['suggestionsByThread',pa])||{}).
agentSuggestions||[],

wa=ta||[];

if(va.length)
wa=v(wa);


var xa=u
(wa.concat(va));


return oa.
setIn(['threadMetadata',pa,'timestamp'],ra).
setIn
(['suggestionsByThread',pa],
{agentSuggestions:xa,quickReplies:ua});}



function x
(oa,
pa,
qa,
ra,
sa){


var ta=s
(pa,
ra);

return ta.reduce
(function(ua,va,wa){return w
(ua,
wa,
va.toJS(),
sa);},

oa);}



function y(oa){
if(!oa)
return null;

var pa=oa.agentSuggestions,
qa=(pa||[]).reduce
(function(ra,sa){
if(sa.messageDepth>=c('MercuryConfig').OmniMMessagesToLive)
return ra;

return ra.concat([babelHelpers['extends']({},sa,{messageDepth:sa.messageDepth+1})]);},

[]);

return babelHelpers['extends']({},oa,{agentSuggestions:qa});}


function z(oa,pa){
var qa=pa.thread_id,ra=pa.message_id,sa=pa.platform_xmd,ta=pa.timestamp;
if(k.has(pa.action_type))
oa=oa.updateIn
(['suggestionsByThread',qa],
y);


return x
(oa,
qa,
ra,
sa,
ta);}



function aa(oa,pa){
if(pa.type!==i.MERCURY_DISPATCHED)
return oa;


var qa=pa.data;
switch(pa.mercuryType){
case 'update-messages':
if(qa.payload_source!==c('MercuryPayloadSource').CLIENT_CHANNEL_MESSAGE)
return oa;

return qa.actions.
filter(function(ra){return j.has(ra.action_type);}).
reduce(z,oa);

case 'invalidate-thread-state':
return oa.
deleteIn(['suggestionsByThread',qa.threadID]).
deleteIn(['threadMetadata',qa.threadID]);
case 'invalidate-global-state':
return oa.
set('suggestionsByThread',c('immutable').Map()).
set('threadMetadata',c('immutable').Map());}


return oa;}


function ba(oa,pa){
if(pa.type!==i.FETCH_SUGGESTIONS)
return oa;

var qa=pa.message,ra=pa.threadID;
return x
(oa,
ra,
qa.message_id,
qa.platform_xmd,
qa.timestamp);}



function ca(oa){
return oa.getIn(['prefs','suggestion_mode'],0);}


function da(oa,pa){
if(pa.type!==i.SUGGESTION_CLICKED)
return oa;

var qa=pa.option,ra=pa.position,sa=pa.source;
if(sa===c('MNOmniMConstants').OMNIM)
c('OmniMLogHelpers').suggestionClicked(qa,ra,ca(oa));

return oa;}


function ea(oa,pa){
if(pa.type!==i.SUGGESTION_COMPLETED)
return oa;

var qa=pa.threadID,ra=pa.option,sa=pa.position,ta=pa.source;
if(ta===c('MNOmniMConstants').OMNIM)
c('OmniMLogHelpers').suggestionCompleted(ra,sa,ca(oa));

return oa.deleteIn(['suggestionsByThread',qa]);}


function fa(oa,pa){
if(pa.type!==i.SUGGESTION_DISMISSED)
return oa;

var qa=pa.threadID,ra=pa.option,sa=pa.source,ta=pa.position;
if(sa===c('MNOmniMConstants').OMNIM)
c('OmniMLogHelpers').suggestionDismissed(ra,ta,ca(oa));



var ua=oa.getIn(['suggestionsByThread',qa]);
if(!ua||!ua.agentSuggestions)
return oa;

var va=ua.agentSuggestions.map(function(wa){
if(wa.suggestionID===ra.suggestionID)
return babelHelpers['extends']({},wa,{dismissed:true});

return wa;});

return oa.setIn
(['suggestionsByThread',qa],babelHelpers['extends']({},
ua,{agentSuggestions:va}));}


function ga
(oa,
pa){

if(pa.type!==i.SUGGESTIONS_DISMISSED_FOR_THREAD)
return oa;

var qa=pa.threadID,
ra=oa.getIn(['suggestionsByThread',qa]);
if(!ra||!ra.agentSuggestions)
return oa;

c('OmniMLogHelpers').barDismissed(ra.agentSuggestions,ca(oa));
var sa=ra.agentSuggestions.map(function(ta,ua){
if(ta.dismissed)
return ta;

c('OmniMLogHelpers').suggestionDismissed(ta,ua,ca(oa));
return babelHelpers['extends']({},ta,{dismissed:true});});


return oa.setIn
(['suggestionsByThread',qa],babelHelpers['extends']({},
ra,{agentSuggestions:sa}));}



function ha(oa,pa){
if(pa.type!==i.PREFS_UPDATED)
return oa;

var qa=pa.prefs;
return oa.updateIn(['prefs'],function(ra){return ra.merge(c('immutable').fromJS(qa));});}


function ia(oa,pa){
if(pa.type!==i.SUGGESTION_MODE_SET)
return oa;

var qa=pa.mode,
ra=c('XMessagingOmniMSetPrefController').
getURIBuilder().
getURI();
new (c('AsyncRequest'))(ra).
setMethod('POST').
setData({suggestion_mode:qa}).
send();
return oa.setIn(['prefs','suggestion_mode'],qa);}


function ja(oa,pa){
if(pa.type!==i.SUGGESTION_DISPLAYED)
return oa;

var qa=pa.option,ra=pa.position;
if(!qa.dismissed)
c('OmniMLogHelpers').suggestionDisplayed(qa,ra,ca(oa));

return oa;}


function ka(oa,pa){
if(pa.type!==i.SUGGESTION_DISAPPEARED)
return oa;

var qa=pa.option,ra=pa.position;
if(!qa.dismissed)
c('OmniMLogHelpers').suggestionDisappeared(qa,ra,ca(oa));

return oa;}


function la(oa,pa){
if(pa.type!==i.BAR_TIMED_OUT)
return oa;

var qa=pa.threadID,ra=pa.options;
c('OmniMLogHelpers').barDisappeared(ra,ca(oa));
return oa.deleteIn(['suggestionsByThread',qa]);}


function ma(oa,pa){
if(pa.type!==i.BAR_DISAPPEARED)
return oa;

c('OmniMLogHelpers').barDisappeared(pa.options,ca(oa));
return oa;}


function na(oa,pa){
if(pa.type!==i.BAR_DISPLAYED)
return oa;

c('OmniMLogHelpers').barDisplayed(pa.options,ca(oa));
return oa;}


f.exports=
{barDisappeared:ma,
barDisplayed:na,
barTimedOut:la,
mercuryDispatch:aa,
messageFetched:ba,
prefsUpdated:ha,
suggestionClicked:da,
suggestionCompleted:ea,
suggestionDisappeared:ka,
suggestionDismissed:fa,
suggestionDisplayed:ja,
suggestionModeSet:ia,
suggestionsDismissedForThread:ga};}),null);

/** js/mercury/clients/messenger/components/omnim/OmniMState.js */






__d('OmniMState',['immutable'],(function a(b,c,d,e,f,g){

'use strict';var h,i,




j=
{suggestionsByThread:c('immutable').Map(),
threadMetadata:c('immutable').Map(),
prefs:c('immutable').Map()};h=babelHelpers.inherits


(k,c('immutable').Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments);}





f.exports=k;}),null);

/** js/mercury/utils/MercuryViewer.js */





__d('MercuryViewer',['CurrentUser','MercuryAssert'],(function a(b,c,d,e,f,g){

'use strict';




var h='fbid:'+c('CurrentUser').getID(),

i=




{getID:function j(){
return h;},







isViewer:function j(k){
c('MercuryAssert').isParticipantID(k);
return k===h;}};



f.exports=i;}),null);

/** www/__virtual__/x/XMessagingOmniMPrefController.js */



__d("XMessagingOmniMPrefController",["XController"],(function a(b,c,d,e,f,g){
f.exports=c("XController").create("\/messaging\/get_omnim_prefs\/",{});}),

null);

/** js/mercury/clients/messenger/components/omnim/OmniMStore.js */






__d('OmniMStore',['AsyncRequest','FluxReduceStore','immutable','MercuryConfig','MercuryDispatcher','MercuryMessages','MessengerFluxReduceDispatcher','OmniMHelpers','OmniMReducer','OmniMState','OmniMActions','XMessagingOmniMPrefController'],(function a(b,c,d,e,f,g){

'use strict';var h,i,
















j=5,

k=[].concat
(Object.values(c('OmniMReducer')));h=babelHelpers.inherits


(l,c('FluxReduceStore'));i=h&&h.prototype;l.prototype.
getInitialState=function(){
return new (c('OmniMState'))();};
l.prototype.

reduce=function(m,n){
if(n.namespace!==c('OmniMActions').Namespace)
return m;

return k.reduce
(function(o,p){return p(o,n);},
m);};

l.prototype.

$OmniMStore_triggerFetch=function(m){
c('MercuryMessages').get().getThreadMessagesRange
(m,
0,
1,
function(n){
if(n&&n.length){
var o=n[0];
c('OmniMActions').messageFetched(m,o);}});};



l.prototype.

$OmniMStore_confidenceThreshold=function(){
var m=this.getState().get('prefs'),
n=c('OmniMHelpers').suggestionMode(m),
o=c('MercuryConfig').OmniMConfidenceThresholds[n];
return o||.9;};
l.prototype.

$OmniMStore_filterForConfidence=
function(m){

var n=this.$OmniMStore_confidenceThreshold();
return (m||[]).
filter(function(o){return o.confidence&&o.confidence>n;});};
l.prototype.

suggestionsForThread=function(m){
var n=this.getState();
if(!n.getIn(['threadMetadata',m]))
this.$OmniMStore_triggerFetch(m);

var o=n.getIn(['suggestionsByThread',m],{}),
p=this.$OmniMStore_filterForConfidence
(o.agentSuggestions).
slice(0,j);
return babelHelpers['extends']({},
o,
{agentSuggestions:p});};

l.prototype.

prefs=function(){
return this.getState().get('prefs');};
l.prototype.

$OmniMStore_setUpDispatcher=function(){
var m=c('MercuryDispatcher').get();
m.subscribe('update-messages',function(n,o){
c('OmniMActions').mercuryDispatched(n,o);});


m.subscribe
('invalidate-thread-state',
function(n,o){
c('OmniMActions').mercuryDispatched(n,{threadID:o});});



m.subscribe
('invalidate-global-state',
function(n){return c('OmniMActions').mercuryDispatched(n);});};

l.prototype.

$OmniMStore_setUpPrefs=function(){
if(c('MercuryConfig').OmniMEditConfidenceThreshold){
var m=c('XMessagingOmniMPrefController').
getURIBuilder().
getURI();
new (c('AsyncRequest'))(m).
setAllowCrossPageTransition(true).
setReadOnly(true).
setMethod('POST').
setHandler(function(n){return c('OmniMActions').prefsUpdated(n.payload);}).
send();}};

l.prototype.

setUp=function(){
this.$OmniMStore_setUpDispatcher();
this.$OmniMStore_setUpPrefs();};
function l(){h.apply(this,arguments);}


f.exports=new l(c('MessengerFluxReduceDispatcher'));}),null);

/** js/mercury/clients/rtc/stats/FBRTCIceStatsParser.js */






__d('FBRTCIceStatsParser',[],(function a(b,c,d,e,f,g){

var h=null;i.






getInstance=function(){'use strict';
if(!h)
h=new i();

return h;};


function i(){'use strict';}
i.prototype.







extractIceInfo=function(j){'use strict';
var k=[],
l=j.split("\r\n");
for(var m=0;m<l.length;m++){
var n=l[m];
if(this.$FBRTCIceStatsParser_isCandidateInfo(n))
k.push
({gen:this.$FBRTCIceStatsParser_getIceCandidateGeneration(n),
type:this.$FBRTCIceStatsParser_getIceType(n)});}



return k;};
i.prototype.




$FBRTCIceStatsParser_isCandidateInfo=function(j){'use strict';
return j.indexOf('candidate:')>-1;};
i.prototype.






$FBRTCIceStatsParser_getIceCandidateGeneration=function(j){'use strict';
var k=0,
l=j.match(/generation (\d+)/);
if(l)
k=parseInt(l[1],10);

return k;};
i.prototype.




$FBRTCIceStatsParser_getIceType=function(j){'use strict';
var k=j.match(/typ (host|relay|srflx|prflx)/);
if(k){
return k[1];}else 

return 'unknown';};






f.exports=i;}),null);

/** js/mercury/clients/rtc/FBRTCCallSummary.js */






__d('FBRTCCallSummary',['FBRTCConstants','FBRTCIceStatsParser','FBRTCLogger','FBRTCUtils','SiteData','UserAgentData','performanceNow'],(function a(b,c,d,e,f,g){









var h=5*60*1000,



i=
{CALL_STARTED:'started',


POPUP_OPENED:'opened',
SENT_OFFER:'s_o',
RECV_OFFER:'r_o',
SENT_OFFER_ACK:'s_oack',
RECV_OFFER_ACK:'r_oack',
SENT_RETRIED_OFFER:'s_o2',
RECV_RETRIED_OFFER:'r_o2',
SENT_RETRIED_OFFER_ACK:'s_oack2',
RECV_RETRIED_OFFER_ACK:'r_oack2',
SENT_PRANSWER:'s_pr',
RECV_PRANSWER:'r_pr',
NETWORK_READY:'network_ready',
SENT_ANSWER:'s_a',
RECV_ANSWER:'r_a',
SENT_ANSWER_ACK:'s_aack',
RECV_ANSWER_ACK:'r_aack',
SENT_RETRIED_ANSWER:'s_a2',
RECV_RETRIED_ANSWER:'r_a2',
SENT_RETRIED_ANSWER_ACK:'s_aack2',
RECV_RETRIED_ANSWER_ACK:'r_aack2',
SENT_OK:'s_ok',
RECV_OK:'r_ok',
CALL_CONNECTED:'connected',
CALL_ENDED:'ended'};


j.CURRENT_SUMMARY_VERSION=19;






function j(k){'use strict';
this.peerID=k.peerID;
this.callID=k.callID;
this.$FBRTCCallSummary_isCaller=k.isCaller;
this.$FBRTCCallSummary_uploadLogLevel=c('FBRTCUtils').getLocalUploadLogLevel();
this.$FBRTCCallSummary_startTime=new Date().valueOf();
this.$FBRTCCallSummary_trigger=null;
this.$FBRTCCallSummary_signalingTime={};
this.$FBRTCCallSummary_endCallReason=null;
this.$FBRTCCallSummary_endCallSubreason=null;
this.$FBRTCCallSummary_isRemoteEnded=null;
this.$FBRTCCallSummary_lastUpdatedTime=null;
this.$FBRTCCallSummary_lastSerializedTime=null;
this.$FBRTCCallSummary_unsetOnRetrieve=null;
this.$FBRTCCallSummary_pcStats={};
this.$FBRTCCallSummary_captureStats={};
this.$FBRTCCallSummary_gen0IceSentCount={};
this.$FBRTCCallSummary_gen0IceReceivedCount={};
this.$FBRTCCallSummary_iceSentCount={};
this.$FBRTCCallSummary_iceReceivedCount={};
this.$FBRTCCallSummary_clientVersion=null;













this.$FBRTCCallSummary_windowStartTime=c('performanceNow')();
this.$FBRTCCallSummary_accumulatedCallTime=0;
this.$FBRTCCallSummary_newSignalingTime={};

this.$FBRTCCallSummary_lastSavedTime=this.$FBRTCCallSummary_windowStartTime;



this.$FBRTCCallSummary_openCount=0;




















this.$FBRTCCallSummary_extraInfo={};


this.addExtraInfo(c('FBRTCLogger').Key.DEVICE_INFO,this.$FBRTCCallSummary_getDeviceInfo());
this.$FBRTCCallSummary_updateLastUpdatedTime();

this.$FBRTCCallSummary_iceStatsParser=c('FBRTCIceStatsParser').getInstance();
this.$FBRTCCallSummary_logger=c('FBRTCLogger').getInstance();}
j.prototype.




toJsonString=function(){'use strict';

this.$FBRTCCallSummary_lastSerializedTime=new Date().valueOf();
return JSON.stringify
({version:j.CURRENT_SUMMARY_VERSION,
peerID:this.peerID,
callID:this.callID,
isCaller:this.$FBRTCCallSummary_isCaller,
uploadLogLevel:this.$FBRTCCallSummary_uploadLogLevel,
clientVersion:this.$FBRTCCallSummary_clientVersion,
callType:this.$FBRTCCallSummary_callType,
conferenceName:this.$FBRTCCallSummary_conferenceName,
serverInfoData:this.$FBRTCCallSummary_serverInfoData,
localVideoDuration:this.$FBRTCCallSummary_localVideoDuration,
remoteVideoDuration:this.$FBRTCCallSummary_remoteVideoDuration,
startTime:this.$FBRTCCallSummary_startTime,
trigger:this.$FBRTCCallSummary_trigger,
signalingTime:this.$FBRTCCallSummary_signalingTime,
endCallReason:this.$FBRTCCallSummary_endCallReason,
endCallSubreason:this.$FBRTCCallSummary_endCallSubreason,
isRemoteEnded:this.$FBRTCCallSummary_isRemoteEnded,
lastUpdatedTime:this.$FBRTCCallSummary_lastUpdatedTime,
lastSerializedTime:this.$FBRTCCallSummary_lastSerializedTime,
unsetOnRetrieve:this.$FBRTCCallSummary_unsetOnRetrieve,
openCount:this.$FBRTCCallSummary_openCount,
extraInfo:this.$FBRTCCallSummary_extraInfo,
pcStats:this.$FBRTCCallSummary_pcStats,
captureStats:this.$FBRTCCallSummary_captureStats,
gen0IceSentCount:this.$FBRTCCallSummary_gen0IceSentCount,
gen0IceReceivedCount:this.$FBRTCCallSummary_gen0IceReceivedCount,
iceSentCount:this.$FBRTCCallSummary_iceSentCount,
iceReceivedCount:this.$FBRTCCallSummary_iceReceivedCount,

newSignalingTime:this.$FBRTCCallSummary_newSignalingTime,
accumulatedCallTime:this.$FBRTCCallSummary_getCurrentTimeFromCallStart()});};

j.





fromJsonString=function(k){'use strict';

var l;

try{l=JSON.parse(k);}catch(
m){

return null;}


if(l.version!==j.CURRENT_SUMMARY_VERSION)

return null;



if(!Object.prototype.hasOwnProperty.call(l,'peerID')||
!Object.prototype.hasOwnProperty.call(l,'callID')||
!Object.prototype.hasOwnProperty.call(l,'isCaller')||
!Object.prototype.hasOwnProperty.call(l,'startTime')||
!Object.prototype.hasOwnProperty.call(l,'trigger')||
!Object.prototype.hasOwnProperty.call(l,'signalingTime')||
!Object.prototype.hasOwnProperty.call(l,'endCallReason')||
!Object.prototype.hasOwnProperty.call(l,'isRemoteEnded')||
!Object.prototype.hasOwnProperty.call(l,'lastUpdatedTime')||
!Object.prototype.hasOwnProperty.call(l,'lastSerializedTime'))
return null;


var n=new j
({peerID:l.peerID,
callID:l.callID,
isCaller:l.isCaller});

n.$FBRTCCallSummary_uploadLogLevel=l.uploadLogLevel;
n.$FBRTCCallSummary_clientVersion=l.clientVersion;
n.$FBRTCCallSummary_startTime=l.startTime;
n.$FBRTCCallSummary_trigger=l.trigger;
n.$FBRTCCallSummary_signalingTime=l.signalingTime;
n.$FBRTCCallSummary_endCallReason=l.endCallReason;
n.$FBRTCCallSummary_endCallSubreason=l.endCallSubreason;
n.$FBRTCCallSummary_isRemoteEnded=l.isRemoteEnded;
n.$FBRTCCallSummary_lastUpdatedTime=l.lastUpdatedTime;
n.$FBRTCCallSummary_lastSerializedTime=l.lastSerializedTime;
if(l.callType)
n.$FBRTCCallSummary_callType=l.callType;

if(l.conferenceName)
n.$FBRTCCallSummary_conferenceName=l.conferenceName;

if(l.serverInfoData)
n.$FBRTCCallSummary_serverInfoData=l.serverInfoData;

if(l.localVideoDuration)
n.$FBRTCCallSummary_localVideoDuration=l.localVideoDuration;

if(l.remoteVideoDuration)
n.$FBRTCCallSummary_remoteVideoDuration=l.remoteVideoDuration;

if(l.unsetOnRetrieve)
n.$FBRTCCallSummary_unsetOnRetrieve=l.unsetOnRetrieve;

if(l.openCount)
n.$FBRTCCallSummary_openCount=l.openCount;

if(l.extraInfo)
n.$FBRTCCallSummary_extraInfo=l.extraInfo;

if(l.pcStats)
n.$FBRTCCallSummary_pcStats=l.pcStats;

if(l.captureStats)
n.$FBRTCCallSummary_captureStats=l.captureStats;

if(l.gen0IceSentCount)
n.$FBRTCCallSummary_gen0IceSentCount=l.gen0IceSentCount;

if(l.gen0IceReceivedCount)
n.$FBRTCCallSummary_gen0IceReceivedCount=l.gen0IceReceivedCount;

if(l.iceSentCount)
n.$FBRTCCallSummary_iceSentCount=l.iceSentCount;

if(l.iceReceivedCount)
n.$FBRTCCallSummary_iceReceivedCount=l.iceReceivedCount;


if(l.newSignalingTime)
n.$FBRTCCallSummary_newSignalingTime=l.newSignalingTime;

if(l.accumulatedCallTime)
n.$FBRTCCallSummary_accumulatedCallTime=l.accumulatedCallTime;


return n;};
j.












restoreOrInitialize=function(k,l,m,n,o){'use strict';
var p=k.retrieveCallSummary(l,m);
if(!p){
p=new j
({peerID:l,
callID:m,
isCaller:n});



if(o){
p.onFullMessageReceived({msg:o});
p.onOfferAckSent(o);}else 

p.onCallStarted(c('FBRTCLogger').Trigger.UNKNOWN);


c('FBRTCLogger').getInstance().logError
(l,
m,
'Missing call summary from storage');}else

if(p.$FBRTCCallSummary_unsetOnRetrieve){
p.$FBRTCCallSummary_endCallReason=null;
p.$FBRTCCallSummary_endCallSubreason=null;
p.$FBRTCCallSummary_isRemoteEnded=null;
delete p.$FBRTCCallSummary_signalingTime[i.CALL_ENDED];

delete p.$FBRTCCallSummary_newSignalingTime[i.CALL_ENDED];
p.$FBRTCCallSummary_unsetOnRetrieve=null;}


return p;};
j.







logSavedSummaries=function(k){'use strict';
var l=k.getLoggableSummaries(),
m=l.length;
if(m<=0)
return;


var n=c('FBRTCLogger').getInstance(),
o=[];
for(var p=0;p<m;p++){
var q=l[p];
n.logEndCallSummary(q);
o.push({peerID:q.peerID,callID:q.callID});}

k.removeCallSummaries(o);
n.logToConsole('Logged pending summaries: '+m);};
j.prototype.


































save=function(k){'use strict';



var l=c('performanceNow')(),
m=l-this.$FBRTCCallSummary_lastSavedTime;
if(m>h){
this.$FBRTCCallSummary_logger.logInfo
(this.peerID,
this.callID,
'Summary too old: '+m);

return;}


k.storeCallSummary
(this.peerID,
this.callID,
this);

this.$FBRTCCallSummary_lastSavedTime=l;};
j.prototype.




getLastUpdatedTime=function(){'use strict';
return this.$FBRTCCallSummary_lastUpdatedTime;};
j.prototype.




setLastUpdatedTime=function(k){'use strict';
this.$FBRTCCallSummary_lastUpdatedTime=k;};
j.prototype.




getExtraInfo=function(){'use strict';
return this.$FBRTCCallSummary_extraInfo;};
j.prototype.




addExtraInfo=function(k,l){'use strict';
this.$FBRTCCallSummary_extraInfo[k]=l;
this.$FBRTCCallSummary_updateLastUpdatedTime();};
j.prototype.

isCaller=function(){'use strict';
return this.$FBRTCCallSummary_isCaller;};
j.prototype.




onCallStarted=function(k){'use strict';
this.$FBRTCCallSummary_trigger=k;
this.$FBRTCCallSummary_setSignalingTime(i.CALL_STARTED);
this.$FBRTCCallSummary_updateLastUpdatedTime();};
j.prototype.




onPopupOpened=function(){'use strict';
this.$FBRTCCallSummary_setSignalingTime(i.POPUP_OPENED);
this.$FBRTCCallSummary_openCount++;
this.$FBRTCCallSummary_updateLastUpdatedTime();};
j.prototype.

setPcStats=function(k){'use strict';
this.$FBRTCCallSummary_pcStats=k;
this.$FBRTCCallSummary_updateLastUpdatedTime();};
j.prototype.

setVideoCaptureStats=function(k,l){'use strict';
this.$FBRTCCallSummary_captureStats=
{w:k,
h:l};

this.$FBRTCCallSummary_updateLastUpdatedTime();};
j.prototype.

setUploadLogLevel=function(k){'use strict';
this.$FBRTCCallSummary_uploadLogLevel=k;
this.$FBRTCCallSummary_updateLastUpdatedTime();};
j.prototype.

setCallType=function(k){'use strict';
this.$FBRTCCallSummary_callType=k;
this.$FBRTCCallSummary_updateLastUpdatedTime();};
j.prototype.

setVideoDurations=function(k,l){'use strict';
this.$FBRTCCallSummary_localVideoDuration=k;
this.$FBRTCCallSummary_remoteVideoDuration=l;
this.$FBRTCCallSummary_updateLastUpdatedTime();};
j.prototype.

setConferenceName=function(k){'use strict';
this.$FBRTCCallSummary_conferenceName=k;
this.$FBRTCCallSummary_updateLastUpdatedTime();};
j.prototype.

setServerInfoData=function(k){'use strict';
this.$FBRTCCallSummary_serverInfoData=k;
this.$FBRTCCallSummary_updateLastUpdatedTime();};
j.prototype.






onOfferAckSent=function(k){'use strict';
this.onMessageSent
({type:c('FBRTCConstants').PayloadType.OFFER_ACK,
flag:k.flag});};

j.prototype.




onMessageSent=function(k){'use strict';

var l=k.flag===1;

switch(k.type){
case c('FBRTCConstants').PayloadType.OFFER:
this.$FBRTCCallSummary_updateStateForRetryableMessage
(l,
i.SENT_OFFER,
i.SENT_RETRIED_OFFER);



this.$FBRTCCallSummary_updateIceInfo(k,this.$FBRTCCallSummary_gen0IceSentCount,this.$FBRTCCallSummary_iceSentCount);
break;
case c('FBRTCConstants').PayloadType.ANSWER:
this.$FBRTCCallSummary_updateStateForRetryableMessage
(l,
i.SENT_ANSWER,
i.SENT_RETRIED_ANSWER);



this.$FBRTCCallSummary_updateIceInfo(k,this.$FBRTCCallSummary_gen0IceSentCount,this.$FBRTCCallSummary_iceSentCount);
break;
case c('FBRTCConstants').PayloadType.OK:
this.$FBRTCCallSummary_setSignalingTime
(i.SENT_OK);

break;
case c('FBRTCConstants').PayloadType.PRANSWER:
this.$FBRTCCallSummary_setSignalingTime
(i.SENT_PRANSWER);

break;
case c('FBRTCConstants').PayloadType.OFFER_ACK:
this.$FBRTCCallSummary_updateStateForRetryableMessage
(l,
i.SENT_OFFER_ACK,
i.SENT_RETRIED_OFFER_ACK);

break;
case c('FBRTCConstants').PayloadType.ANSWER_ACK:
this.$FBRTCCallSummary_updateStateForRetryableMessage
(l,
i.SENT_ANSWER_ACK,
i.SENT_RETRIED_ANSWER_ACK);

break;
case c('FBRTCConstants').PayloadType.ICE_CANDIDATE:
this.$FBRTCCallSummary_updateIceInfo(k,this.$FBRTCCallSummary_gen0IceSentCount,this.$FBRTCCallSummary_iceSentCount);
break;
default:}


this.$FBRTCCallSummary_updateLastUpdatedTime();};
j.prototype.

$FBRTCCallSummary_updateIceInfo=function(k,l,m){'use strict';
var n=null,
o=null,
p=this.$FBRTCCallSummary_iceStatsParser.extractIceInfo(k.sdp);
for(var q=0;q<p.length;q++){
n=p[q].gen;
o=p[q].type;
if(n===0)
this.$FBRTCCallSummary_addCount(l,o);

this.$FBRTCCallSummary_addCount(m,o);}};

j.prototype.

$FBRTCCallSummary_addCount=function(k,l){'use strict';
if(!k[l]){
k[l]=1;}else 

k[l]=k[l]+1;};

j.prototype.




$FBRTCCallSummary_maybeSetPeerIsMobile=function(k){'use strict';
if(k.isFromMobile())
this.addExtraInfo(c('FBRTCLogger').Key.PEER_IS_MOBILE,'1');};

j.prototype.





onFullMessageReceived=function(k){'use strict';
var l=k.msg,


m=l.flag===1;

switch(l.type){
case c('FBRTCConstants').PayloadType.OFFER:

this.$FBRTCCallSummary_maybeSetPeerIsMobile(k);
this.$FBRTCCallSummary_updateStateForRetryableMessage
(m,
i.RECV_OFFER,
i.RECV_RETRIED_OFFER);



this.$FBRTCCallSummary_updateIceInfo
(l,
this.$FBRTCCallSummary_gen0IceReceivedCount,
this.$FBRTCCallSummary_iceReceivedCount);

break;
case c('FBRTCConstants').PayloadType.ANSWER:

this.$FBRTCCallSummary_maybeSetPeerIsMobile(k);
this.$FBRTCCallSummary_updateStateForRetryableMessage
(m,
i.RECV_ANSWER,
i.RECV_RETRIED_ANSWER);



this.$FBRTCCallSummary_updateIceInfo
(l,
this.$FBRTCCallSummary_gen0IceReceivedCount,
this.$FBRTCCallSummary_iceReceivedCount);

break;
case c('FBRTCConstants').PayloadType.OK:
this.$FBRTCCallSummary_setSignalingTime
(i.RECV_OK);

break;
case c('FBRTCConstants').PayloadType.PRANSWER:
this.$FBRTCCallSummary_setSignalingTime
(i.RECV_PRANSWER);

break;
case c('FBRTCConstants').PayloadType.OFFER_ACK:
this.$FBRTCCallSummary_updateStateForRetryableMessage
(m,
i.RECV_OFFER_ACK,
i.RECV_RETRIED_OFFER_ACK);

break;
case c('FBRTCConstants').PayloadType.ANSWER_ACK:
this.$FBRTCCallSummary_updateStateForRetryableMessage
(m,
i.RECV_ANSWER_ACK,
i.RECV_RETRIED_ANSWER_ACK);

break;
case c('FBRTCConstants').PayloadType.ICE_CANDIDATE:
this.$FBRTCCallSummary_updateIceInfo
(l,
this.$FBRTCCallSummary_gen0IceReceivedCount,
this.$FBRTCCallSummary_iceReceivedCount);

break;
default:}


this.$FBRTCCallSummary_updateLastUpdatedTime();};
j.prototype.





onMsgAckReceived=function(k,l){'use strict';
var m=k.msg.flag===1;
if(l){
this.$FBRTCCallSummary_updateStateForRetryableMessage
(m,
i.RECV_OFFER_ACK,
i.RECV_RETRIED_OFFER_ACK);}else 


this.$FBRTCCallSummary_updateStateForRetryableMessage
(m,
i.RECV_ANSWER_ACK,
i.RECV_RETRIED_ANSWER_ACK);};


j.prototype.

onNetworkReady=function(){'use strict';
this.$FBRTCCallSummary_setSignalingTime(i.NETWORK_READY);
this.$FBRTCCallSummary_updateLastUpdatedTime();};
j.prototype.




onCallConnected=function(){'use strict';


this.$FBRTCCallSummary_setSignalingTime(i.NETWORK_READY);
this.$FBRTCCallSummary_setSignalingTime(i.CALL_CONNECTED);
this.$FBRTCCallSummary_updateLastUpdatedTime();};
j.prototype.










onCallEnded=function(k,l,m,n){'use strict';
this.$FBRTCCallSummary_unsetOnRetrieve=m;
this.$FBRTCCallSummary_endCallReason=k;
this.$FBRTCCallSummary_endCallSubreason=n;
this.$FBRTCCallSummary_isRemoteEnded=l;
this.$FBRTCCallSummary_setSignalingTime(i.CALL_ENDED);
this.$FBRTCCallSummary_updateLastUpdatedTime();};
j.prototype.

setOfferSentTime=function(){'use strict';
this.$FBRTCCallSummary_setSignalingTime(i.SENT_OFFER);};
j.prototype.

setOfferAckReceivedTime=function(){'use strict';
this.$FBRTCCallSummary_setSignalingTime(i.RECV_OFFER_ACK);};
j.prototype.

setAnswerSentTime=function(){'use strict';
this.$FBRTCCallSummary_setSignalingTime(i.SENT_ANSWER);};
j.prototype.

setAnswerReceivedTime=function(){'use strict';
this.$FBRTCCallSummary_setSignalingTime(i.RECV_ANSWER);};
j.prototype.




toString=function(){'use strict';
var k={};
k.core_metrics=this.$FBRTCCallSummary_getCoreMetrics();
k.time_series=null;
return JSON.stringify(k);};
j.prototype.

$FBRTCCallSummary_getCoreMetrics=function(){'use strict';
var k={};
k.ver=j.CURRENT_SUMMARY_VERSION;
k.log_level=c('FBRTCConstants').uploadLogLevelString(this.$FBRTCCallSummary_uploadLogLevel);
k.caller=this.$FBRTCCallSummary_isCaller;
k.call_type=this.$FBRTCCallSummary_callType;
k.conf_name=this.$FBRTCCallSummary_conferenceName;
k.serv_info=this.$FBRTCCallSummary_serverInfoData;
k.conn=this.$FBRTCCallSummary_getConnectionStats();
k.peer_id=this.peerID;

k.has_video=true;
k.open_count=this.$FBRTCCallSummary_openCount;
k.signaling=this.$FBRTCCallSummary_getSignalingStats();
k.sender=this.$FBRTCCallSummary_getSenderStats();
k.receiver=this.$FBRTCCallSummary_getReceiverStats();
k.end=this.$FBRTCCallSummary_getEndStats();
k.video=this.$FBRTCCallSummary_getVideoStats();
k.push_phase=c('SiteData').push_phase;
k.client_version=this.$FBRTCCallSummary_clientVersion;
return k;};
j.prototype.

$FBRTCCallSummary_getConnectionStats=function(){'use strict';
var k={dtls:1};
if(this.$FBRTCCallSummary_pcStats.sender&&this.$FBRTCCallSummary_pcStats.sender.rtt)
k.rtt=this.$FBRTCCallSummary_pcStats.sender.rtt;

return k;};
j.prototype.

$FBRTCCallSummary_getSignalingStats=function(){'use strict';
var k={};
if(this.$FBRTCCallSummary_trigger)
k.trigger=this.$FBRTCCallSummary_trigger;

k.start_time=this.$FBRTCCallSummary_startTime;
k.time_from_start=this.$FBRTCCallSummary_signalingTime;





var l=
this.$FBRTCCallSummary_signalingTime[i.CALL_CONNECTED],
m=this.$FBRTCCallSummary_signalingTime[i.CALL_ENDED];
if(l){
if(!m)




if(this.$FBRTCCallSummary_lastSerializedTime){




m=this.$FBRTCCallSummary_lastSerializedTime-this.$FBRTCCallSummary_startTime;}else 

m=this.$FBRTCCallSummary_getCurrentTimeFromStart();


var n=m-l;
if(n>0)
k.duration=n;}





k.new_time_from_start=this.$FBRTCCallSummary_newSignalingTime;
l=
this.$FBRTCCallSummary_newSignalingTime[i.CALL_CONNECTED];
m=this.$FBRTCCallSummary_newSignalingTime[i.CALL_ENDED];
if(l){
if(!m)
if(this.$FBRTCCallSummary_accumulatedCallTime>0){
m=this.$FBRTCCallSummary_accumulatedCallTime;}else 

m=this.$FBRTCCallSummary_getCurrentTimeFromCallStart();


n=m-l;
if(n>0)
k.new_duration=n;}



return k;};
j.prototype.

$FBRTCCallSummary_getSenderStats=function(){'use strict';
var k={};
if(this.$FBRTCCallSummary_gen0IceSentCount)
k.ice_g0=this.$FBRTCCallSummary_gen0IceSentCount;

if(this.$FBRTCCallSummary_iceSentCount)
k.ice=this.$FBRTCCallSummary_iceSentCount;

if(this.$FBRTCCallSummary_pcStats.sender)
Object.assign(k,this.$FBRTCCallSummary_pcStats.sender);

return k;};
j.prototype.

$FBRTCCallSummary_getReceiverStats=function(){'use strict';
var k={};
if(this.$FBRTCCallSummary_gen0IceReceivedCount)
k.ice_g0=this.$FBRTCCallSummary_gen0IceReceivedCount;

if(this.$FBRTCCallSummary_iceReceivedCount)
k.ice=this.$FBRTCCallSummary_iceReceivedCount;

return k;};
j.prototype.

$FBRTCCallSummary_getEndStats=function(){'use strict';
var k={};
if(this.$FBRTCCallSummary_endCallReason!==null){
k.end_call_reason_string=
c('FBRTCConstants').callEndReasonString(this.$FBRTCCallSummary_endCallReason);
if(this.$FBRTCCallSummary_endCallSubreason!==null)
k.end_call_subreason_string=this.$FBRTCCallSummary_endCallSubreason;

k.remote_ended=this.$FBRTCCallSummary_isRemoteEnded;}

if(this.$FBRTCCallSummary_pcStats.end)
Object.assign(k,this.$FBRTCCallSummary_pcStats.end);

return k;};
j.prototype.

$FBRTCCallSummary_getVideoStats=function(){'use strict';
var k={capture:{}};
if(this.$FBRTCCallSummary_pcStats.video&&this.$FBRTCCallSummary_pcStats.video.sender)
Object.assign(k,this.$FBRTCCallSummary_pcStats.video.sender);

if(this.$FBRTCCallSummary_captureStats)
Object.assign(k.capture,this.$FBRTCCallSummary_captureStats);


return {sender:k,
ld:this.$FBRTCCallSummary_localVideoDuration,
rd:this.$FBRTCCallSummary_remoteVideoDuration};};

j.prototype.





$FBRTCCallSummary_getCurrentTimeFromStart=function(){'use strict';
return new Date().valueOf()-this.$FBRTCCallSummary_startTime;};
j.prototype.







$FBRTCCallSummary_getCurrentTimeFromCallStart=function(){'use strict';
var k=c('performanceNow')()-this.$FBRTCCallSummary_windowStartTime;
return Math.floor(this.$FBRTCCallSummary_accumulatedCallTime+k);};
j.prototype.




$FBRTCCallSummary_setSignalingTime=function(k){'use strict';
if(this.$FBRTCCallSummary_signalingTime[k])

return;



this.$FBRTCCallSummary_signalingTime[k]=this.$FBRTCCallSummary_getCurrentTimeFromStart();
this.$FBRTCCallSummary_newSignalingTime[k]=this.$FBRTCCallSummary_getCurrentTimeFromCallStart();};
j.prototype.




$FBRTCCallSummary_updateStateForRetryableMessage=function(k,l,m){'use strict';
if(k){
this.$FBRTCCallSummary_setSignalingTime(m);}else 

this.$FBRTCCallSummary_setSignalingTime(l);};

j.prototype.







$FBRTCCallSummary_updateLastUpdatedTime=function(){'use strict';
this.$FBRTCCallSummary_lastUpdatedTime=new Date().valueOf();};
j.prototype.













$FBRTCCallSummary_getDeviceInfo=function(){'use strict';

return {device:c('UserAgentData').deviceName,
os:c('UserAgentData').platformName,
os_version:c('UserAgentData').platformFullVersion,
browser:c('UserAgentData').browserName,
browser_version:c('UserAgentData').browserFullVersion,
screen_height:window.screen.availHeight,
screen_width:window.screen.availWidth};};

j.prototype.




setClientVersion=function(k){'use strict';
this.$FBRTCCallSummary_clientVersion=k;};



f.exports=j;}),null);

/** js/mercury/clients/rtc/FBRTCCallSummaryStore.js */




















__d('FBRTCCallSummaryStore',['CacheStorage','FBRTCCallSummary','FBRTCLogger','areEqual'],(function a(b,c,d,e,f,g){






var h='localstorage',
i='RTC_CALL_SUMMARY_',
j='summary',
k=2000,
l=3,


m=3*60*1000,

n=null;o.


getInstance=function(){'use strict';
if(!n)
n=new o();

return n;};


function o(){'use strict';
this.$FBRTCCallSummaryStore_storage=new (c('CacheStorage'))(h,i);
this.$FBRTCCallSummaryStore_logger=c('FBRTCLogger').getInstance();}
o.prototype.








storeCallSummary=function(p,q,r){'use strict';
var s=this;
this.$FBRTCCallSummaryStore_getAndSetCallSummaries
(function(t){
if(!t[p])
t[p]={};



var u=t[p][q];
if(u){
var v=s.$FBRTCCallSummaryStore_deserialize(u);
if(v&&v.getLastUpdatedTime()>
r.getLastUpdatedTime()){
s.$FBRTCCallSummaryStore_logger.logToConsole('Outdated summaries');
return null;}}



t[p][q]=s.$FBRTCCallSummaryStore_serialize(r);
return t;},

s.$FBRTCCallSummaryStore_logger.logError.bind(s.$FBRTCCallSummaryStore_logger,p,q));};

o.prototype.








retrieveCallSummary=function(p,q){'use strict';
var r=this.$FBRTCCallSummaryStore_getCallSummaries(),
s=null;
if(r[p])
s=r[p][q];

if(s){
return this.$FBRTCCallSummaryStore_deserialize(s);}else 

return null;};

o.prototype.







removeCallSummary=function(p,q){'use strict';
this.removeCallSummaries([{peerID:p,callID:q}]);};
o.prototype.







removeCallSummaries=function(p){'use strict';
var q=this;
this.$FBRTCCallSummaryStore_getAndSetCallSummaries
(function(r){
var s=p.length;


for(var t=0;t<s;t++){
var u=p[t].peerID,
v=p[t].callID;
if(r[u]&&r[u][v]){
delete r[u][v];
if(q.$FBRTCCallSummaryStore_isEmpty(r[u]))
delete r[u];}}




return r;},

q.$FBRTCCallSummaryStore_logger.logError.bind(q.$FBRTCCallSummaryStore_logger,null,null));};

o.prototype.





getLoggableSummaries=function(){'use strict';
var p=this.$FBRTCCallSummaryStore_getCallSummaries(),
q=[];

for(var r in p)
if(Object.prototype.hasOwnProperty.call(p,r))
for(var s in p[r])
if(Object.prototype.hasOwnProperty.call(p[r],s)){
var t=this.$FBRTCCallSummaryStore_deserialize(p[r][s],m);
if(t)
q.push(t);}






return q;};
o.prototype.




$FBRTCCallSummaryStore_isEmpty=function(p){'use strict';
for(var q in p)
if(Object.prototype.hasOwnProperty.call(p,q))
return false;


return true;};
o.prototype.
















$FBRTCCallSummaryStore_serialize=function(p){'use strict';
var q=
{__t:Date.now(),
__d:p.toJsonString()};

return q;};
o.prototype.








$FBRTCCallSummaryStore_deserialize=function(p,q){'use strict';
if(p)
if(!q||Date.now()-p.__t>=q)
return c('FBRTCCallSummary').fromJsonString(p.__d);


return null;};
o.prototype.





$FBRTCCallSummaryStore_getCallSummaries=function(){'use strict';
var p=this.$FBRTCCallSummaryStore_storage.get(j)||{};
return p;};
o.prototype.

























$FBRTCCallSummaryStore_getAndSetCallSummaries=function(p,q,r,s){'use strict';
if(r===undefined||r===null)
r=l;




var t=this.$FBRTCCallSummaryStore_getCallSummaries(),
u=this.$FBRTCCallSummaryStore_getCallSummaries(),


v=p(t);


if(v===null)
return;



var w=this.$FBRTCCallSummaryStore_getCallSummaries();
if(c('areEqual')(u,w)){
this.$FBRTCCallSummaryStore_storage.set(j,v);
this.$FBRTCCallSummaryStore_logger.logToConsole('Updated summaries');}else 

if(r>0){
q('Retry lock');
if(s){

var x=this;
setTimeout(function(){
x.$FBRTCCallSummaryStore_getAndSetCallSummaries(p,q,r-1,true);},
k);}else 


this.$FBRTCCallSummaryStore_getAndSetCallSummaries(p,q,r-1,true);}else 


q('Failed to lock');};





f.exports=o;}),null);

/** js/mercury/clients/rtc/FBRTCCallSummaryUploader.js */










__d('FBRTCCallSummaryUploader',['Banzai','FBRTCCallSummary','FBRTCCallSummaryStore'],(function a(b,c,d,e,f,g){





var h=






{init:function i(){
var j=c('FBRTCCallSummaryStore').getInstance();
c('Banzai').subscribe(c('Banzai').SEND,function(){
c('FBRTCCallSummary').logSavedSummaries(j);});}};




f.exports=h;}),null);

/** js/mercury/clients/shared/HotLikeSound.js */






__d('HotLikeSound',['MercurySoundsConfig','SoundPlayer','StickerConstants'],(function a(b,c,d,e,f,g){

'use strict';





var h=
[c('MercurySoundsConfig').hot_like_grow_mp3_url,
c('MercurySoundsConfig').hot_like_grow_ogg_url],


i=
[c('MercurySoundsConfig').hot_like_pop_mp3_url,
c('MercurySoundsConfig').hot_like_pop_ogg_url],


j=
[c('MercurySoundsConfig').hot_like_outgoing_small_mp3_url,
c('MercurySoundsConfig').hot_like_outgoing_small_ogg_url],


k=
[c('MercurySoundsConfig').hot_like_outgoing_medium_mp3_url,
c('MercurySoundsConfig').hot_like_outgoing_medium_ogg_url],


l=
[c('MercurySoundsConfig').hot_like_outgoing_large_mp3_url,
c('MercurySoundsConfig').hot_like_outgoing_large_ogg_url],


m=function o(){return false;},

n=
{setCheckSoundEnabledFunc:function o(p){
m=p;},


start:function o(){
this._play(h);},


stop:function o(){
c('SoundPlayer').stop(h);},


pop:function o(){
this.stop();
this._play(i);},


snap:function o(p){
this.stop();
if(p===c('StickerConstants').HOT_LIKE_SMALL_STICKER_ID)
this._play(j);

if(p===c('StickerConstants').HOT_LIKE_MEDIUM_STICKER_ID)
this._play(k);

if(p===c('StickerConstants').HOT_LIKE_LARGE_STICKER_ID)
this._play(l);},



_play:function o(p){
if(m())
c('SoundPlayer').play(p);}};




f.exports=n;}),null);

/** js/mercury/clients/sidebar/sheet/ChatSidebarSheetChatOffline.react.js */






__d('ChatSidebarSheetChatOffline.react',['fbt','Link.react','React'],(function a(b,c,d,e,f,g,h){

'use strict';var i,j,






k=c('React').PropTypes;i=babelHelpers.inherits

(l,c('React').PureComponent);j=i&&i.prototype;l.prototype.






render=function(){

return (c('React').createElement('div',null,h._(["{=Go online} to see who's available.","6f8fa7200ab56f4f93eddc7748bdac42"],[h.param



('=Go online',
c('React').createElement(c('Link.react'),
{className:'fbChatGoOnlineLink',
onClick:this.props.onGoOnlineClick},h._(["Turn on chat","dc531e432c731b15da58ec4240b9dc09"])))])));};









function l(){i.apply(this,arguments);}l.propTypes={onGoOnlineClick:k.func.isRequired};


f.exports=l;}),null);

/** js/mercury/clients/sidebar/sheet/ChatSidebarSheetChatReconnectMsg.react.js */






__d('ChatSidebarSheetChatReconnectMsg.react',['fbt','ChannelConstants','Link.react','MessengerSpinner.react','React'],(function a(b,c,d,e,f,g,h){

'use strict';var i,j,








k=c('React').PropTypes;i=babelHelpers.inherits

(l,c('React').PureComponent);j=i&&i.prototype;l.prototype.












render=function(){var m=
this.props,n=m.isMessenger,o=m.msecs,

p=
c('React').createElement(c('Link.react'),
{className:'fbChatReconnectLink',
onClick:this.props.onManuallyConnectClick},h._(["No Internet Connection","ff693336c2c0d6d26e89922d288be337"]));









if(o==null||false===navigator.onLine){

return (n?
p:
c('React').createElement('div',null,h._(["Unable to connect to chat. Check your Internet connection.","9eafb88761d5e840d3446654fdeef12c"])));}else








if(o>c('ChannelConstants').WARNING_COUNTDOWN_THRESHOLD_MSEC){

return (n?
p:
c('React').createElement('div',null,h._(["Unable to connect to chat. {try-again-link}","13bd5c6d27dde5771b0ab425139460bc"],[h.param





('try-again-link',
c('React').createElement(c('Link.react'),
{className:'fbChatReconnectLink',
onClick:this.props.onManuallyConnectClick},h._(["Try again","06053143742f8700d5791b5f8b8b1a80"])))])));}else










if(o>1000){

return (n?
p:
c('React').createElement('div',null,h._(["Unable to connect to chat. Reconnecting in {seconds}","2fd09da8de16472979cf7ae13ce535d9"],[h.param










('seconds',Math.floor(o/1000))])));}else 





return (n?
c('React').createElement('div',null,
c('React').createElement(c('MessengerSpinner.react'),{color:'grey'}),h._(["Connecting...","b724f13f028584315d2154aba9dc0012"])):







c('React').createElement('div',null,h._(["Unable to connect to chat. Reconnecting...","2461765b69986fa99494eb97f73db2d5"])));};








function l(){i.apply(this,arguments);}l.propTypes={isMessenger:k.bool,msecs:k.number,onManuallyConnectClick:k.func};


f.exports=l;}),null);

/** js/mercury/clients/sidebar/sheet/ChatSidebarSheetChatShutdownMsg.react.js */






__d('ChatSidebarSheetChatShutdownMsg.react',['fbt','ChannelConstants','React'],(function a(b,c,d,e,f,g,h){

'use strict';var i,j,






k=c('React').PropTypes;i=babelHelpers.inherits

(l,c('React').PureComponent);j=i&&i.prototype;l.prototype.










render=function(){var m=
this.props,n=m.hint,o=m.isMessenger;

switch(n){
case c('ChannelConstants').HINT_AUTH:

return (c('React').createElement('div',null,h._(["Your session has timed out. Please log in.","e6f239233ea96cea869ae983ace7fc47"])));





case c('ChannelConstants').HINT_MAINT:

return (o?
c('React').createElement('div',null,h._(["Messenger is currently down for maintenance.","38d6b23f0dd11a4132a7dbc3d5b09c96"])):






c('React').createElement('div',null,h._(["Facebook {Chat} is currently down for maintenance.","fa121455b264f88a15d2a347412868b9"],[h.param




('Chat',h._(["Chat","15da99718f70f0f31b031d8310128036"]))])));








case c('ChannelConstants').HINT_CONN:


default:return (o?
c('React').createElement('div',null,h._(["Messenger is currently unavailable.","b4aaec04a68ed6de66eaf8aec062ab95"])):







c('React').createElement('div',null,h._(["Facebook {Chat} is currently unavailable.","d1c3eeb28f21514273e102138a190db3"],[h.param





('Chat',h._(["Chat","15da99718f70f0f31b031d8310128036"]))])));}};









function l(){i.apply(this,arguments);}l.propTypes={hint:k.string,isMessenger:k.bool};


f.exports=l;}),null);

/** js/mercury/clients/sidebar/sheet/ChatSidebarSheet.react.js */






__d('ChatSidebarSheet.react',['fbt','Arbiter','ChannelConnection','ChatBehavior','ChatSidebarSheetChatOffline.react','ChatSidebarSheetChatReconnectMsg.react','ChatSidebarSheetChatShutdownMsg.react','ChatVisibility','MessengerEnvironment','CSS','JSLogger','LogHistory','MercurySyncConstants','PresencePrivacy','React','SubscriptionsHandler','emptyFunction','joinClasses','setTimeoutAcrossTransitions'],(function a(b,c,d,e,f,g,h){

'use strict';var i,j,






















k=c('JSLogger').create('sidebar_sheet'),
l=c('LogHistory').getInstance('sidebar_sheet'),

m=c('React').PropTypes;i=babelHelpers.inherits















(n,c('React').PureComponent);j=i&&i.prototype;







function n(o){
j.constructor.call(this,o);this.











































































































$ChatSidebarSheet_handleConnectionChange=function(p,q){
this.setState
({channelStatus:p,
channelData:q});

this.$ChatSidebarSheet_calculateState();}.
bind(this);this.

$ChatSidebarSheet_calculateState=function(){
this.setState
({isConnected:!c('ChannelConnection').disconnected(),
isOnline:c('ChatVisibility').isOnline(),
notifiesUserMessages:c('ChatBehavior').notifiesUserMessages()});}.

bind(this);this.state={channelStatus:null,channelData:null,isConnected:!c('ChannelConnection').disconnected(),isOnline:c('ChatVisibility').isOnline(),notifiesUserMessages:c('ChatBehavior').notifiesUserMessages(),syncStateInvalid:false,syncStateReconnecting:false};}n.prototype.componentDidMount=function(){this.$ChatSidebarSheet_subscriptions=new (c('SubscriptionsHandler'))();this.$ChatSidebarSheet_subscriptions.addSubscriptions(c('ChannelConnection').subscribe([c('ChannelConnection').CONNECTED,c('ChannelConnection').SHUTDOWN,c('ChannelConnection').RECONNECTING],this.$ChatSidebarSheet_handleConnectionChange),c('ChannelConnection').subscribe([c('ChannelConnection').MUTE_WARNING,c('ChannelConnection').UNMUTE_WARNING],this.$ChatSidebarSheet_calculateState),c('PresencePrivacy').subscribe('privacy-user-presence-changed',this.$ChatSidebarSheet_calculateState),c('ChatBehavior').subscribe(c('ChatBehavior').ON_CHANGED,this.$ChatSidebarSheet_calculateState),c('Arbiter').subscribe(c('MercurySyncConstants').ARBITER_EVENT_INVALID_STATE,function(){l.log('invalid state fatal','{}');this.setState({syncStateInvalid:true,syncStateReconnecting:false});}.bind(this)),c('Arbiter').subscribe(c('MercurySyncConstants').ARBITER_EVENT_INVALID_STATE_RETRY,function(){l.log('retry from invalid state','{}');this.$ChatSidebarSheet_enterRetryState();}.bind(this)),c('Arbiter').subscribe(c('MercurySyncConstants').ARBITER_EVENT_INVALID_STATE_RECOVER,function(){l.log('recover from invalid state','{}');this.$ChatSidebarSheet_recoverAfterRetryState();}.bind(this)));};n.prototype.componentWillUpdate=function(){if(this.$ChatSidebarSheet_showWarningTimeout){clearTimeout(this.$ChatSidebarSheet_showWarningTimeout);this.$ChatSidebarSheet_showWarningTimeout=null;}};n.prototype.componentWillUnmount=function(){this.$ChatSidebarSheet_subscriptions&&this.$ChatSidebarSheet_subscriptions.release();};n.prototype.render=function(){var o=c('MessengerEnvironment').messengerui,p=void 0,q=void 0;if(!this.state.isOnline&&!o){p='offline';q=this.$ChatSidebarSheet_renderOffline();}else if(!this.state.isConnected||this.state.syncStateInvalid||this.state.syncStateReconnecting){p='error';q=this.$ChatSidebarSheet_renderGeneralConnectionError(o);}else if(!this.state.notifiesUserMessages&&!o){p='notice';q=this.$ChatSidebarSheet_renderNotice();}if(this.state.channelStatus===c('ChannelConnection').RECONNECTING&&this.state.channelData<1000||this.state.syncStateReconnecting)p=c('joinClasses')(p,'reconnecting');return c('React').createElement('div',{className:c('joinClasses')(this.props.className,p)},o?null:c('React').createElement('div',{className:'img'}),c('React').createElement('div',{className:'message'},q));};n.prototype.

$ChatSidebarSheet_renderGeneralConnectionError=function(o){







if(this.state.channelStatus===c('ChannelConnection').SHUTDOWN||
this.state.syncStateInvalid){


return (c('React').createElement(c('ChatSidebarSheetChatShutdownMsg.react'),
{hint:
this.state.syncStateInvalid?
undefined:
this.state.channelData,

isMessenger:o}));}else


if(this.state.channelStatus===c('ChannelConnection').RECONNECTING||
this.state.syncStateReconnecting){
var p=this.state.syncStateReconnecting?
1:
this.state.channelData;

if(p>1000)
this.$ChatSidebarSheet_showWarningTimeout=c('setTimeoutAcrossTransitions')
(this.$ChatSidebarSheet_handleConnectionChange.bind
(this,
c('ChannelConnection').RECONNECTING,
p-1000),

1000);




return (c('React').createElement(c('ChatSidebarSheetChatReconnectMsg.react'),
{isMessenger:o,
msecs:p,
onManuallyConnectClick:function(){
if(!this.state.syncStateReconnecting)
c('ChannelConnection').reconnect();}.

bind(this)}));}




return null;};
n.prototype.

$ChatSidebarSheet_renderOffline=function(){

return (c('React').createElement(c('ChatSidebarSheetChatOffline.react'),
{onGoOnlineClick:function o(p){
k.log('sidebar_go_online');
c('ChatVisibility').goOnline();}}));};



n.prototype.

$ChatSidebarSheet_renderNotice=function(){

return (c('React').createElement('div',null,h._(["Alerts are off while you use another client to chat.","eb5ca1718072b2bb2a9317341130b8c1"])));};





n.prototype.

$ChatSidebarSheet_enterRetryState=function(){
this.setState


({syncStateReconnecting:true});};

n.prototype.

$ChatSidebarSheet_recoverAfterRetryState=function(){
this.setState


({syncStateInvalid:false,
syncStateReconnecting:false});};





f.exports=n;}),null);

/** js/mercury/models/MercuryBlockedParticipants.js */






__d('MercuryBlockedParticipants',['MercuryIDs','MercuryActionType','MercuryDispatcher','MercurySingletonProvider','Set'],(function a(b,c,d,e,f,g){

'use strict';h.









getForFBID=function(j){
return i.getForFBID(j);};
h.

get=function(){
return i.get();};






function h(j){
this.$MercuryBlockedParticipants_fbid=j;
this.$MercuryBlockedParticipants_blockedIDs=new (c('Set'))();
this.$MercuryBlockedParticipants_dispatcher=c('MercuryDispatcher').getForFBID(this.$MercuryBlockedParticipants_fbid);
this.$MercuryBlockedParticipants_dispatcher.subscribe('update-blocked-users',function(k,l){
if(l.message_blocked_ids)

this.$MercuryBlockedParticipants_blockedIDs=new (c('Set'))(l.message_blocked_ids);


var m=l.participants||[];
for(var n=m,o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var q;if(o){if(p>=n.length)break;q=n[p++];}else{p=n.next();if(p.done)break;q=p.value;}var r=q;
if(r.is_messenger_blocked===true)
this.$MercuryBlockedParticipants_addID(r.fbid);

if(r.is_messenger_blocked===false)
this.$MercuryBlockedParticipants_deleteID(r.fbid);}}.


bind(this));}
h.prototype.

getFBID=function(){
return this.$MercuryBlockedParticipants_fbid;};
h.prototype.

setIDs=function(j){
this.$MercuryBlockedParticipants_blockedIDs=j;};
h.prototype.

getIDs=function(){
return this.$MercuryBlockedParticipants_getIDs();};
h.prototype.

$MercuryBlockedParticipants_getIDs=function(){
return this.$MercuryBlockedParticipants_blockedIDs;};
h.prototype.

$MercuryBlockedParticipants_addID=function(j){
this.$MercuryBlockedParticipants_blockedIDs.add
(c('MercuryIDs').getParticipantIDFromUserID(j.toString()));};

h.prototype.

$MercuryBlockedParticipants_deleteID=function(j){
this.$MercuryBlockedParticipants_blockedIDs['delete']
(c('MercuryIDs').getParticipantIDFromUserID(j.toString()));};

h.prototype.

isMessageBlocked=function(j){
if(!j.is_canonical)
return false;

var k=j.participants.filter
(function(l){return l!=c('MercuryIDs').getParticipantIDFromUserID(this.getFBID());}.bind(this));


return !k.every(function(l){return !this.$MercuryBlockedParticipants_blockedIDs.has(l);}.bind(this));};
h.prototype.

isPresentInGroupThread=function(j){
if(!j.is_canonical&&this.$MercuryBlockedParticipants_findIntersection(j).length>0)
return true;

return false;};
h.prototype.

inGroupThread=function(j){
if(j.is_canonical)
return [];

return this.$MercuryBlockedParticipants_findIntersection(j);};
h.prototype.

$MercuryBlockedParticipants_findIntersection=function(j){
if(!j.participants)
return [];


var k=j.participants.filter
(function(m){return m!=c('MercuryIDs').getParticipantIDFromUserID(this.getFBID());}.bind(this)),


l=k.filter
(function(m){return this.$MercuryBlockedParticipants_blockedIDs.has(m)!==false;}.bind(this));

return l;};



var i=new (c('MercurySingletonProvider'))(h);
f.exports=h;}),null);

/** shared/mercury/channel/MercuryChannelMessageTransformer.js */






__d('MercuryChannelMessageTransformer',['MercuryActionType'],(function a(b,c,d,e,f,g){

'use strict';








function h(i,j){
var k=
{author:i.mercury_author_id,
author_email:i.mercury_author_email,
body:i.body,
subject:i.subject,
has_attachment:i.has_attachment,
attachments:i.attachments,
ephemeral_ttl_mode:i.ephemeral_ttl_mode,
html_body:i.html_body,
thread_id:i.tid,
thread_fbid:i.thread_fbid&&
i.thread_fbid.toString(),
other_user_fbid:i.other_user_fbid&&
i.other_user_fbid.toString(),
offline_threading_id:i.offline_threading_id,
message_id:i.mid,
is_spoof_warning:i.is_spoof_warning,
ranges:i.ranges,
source:i.mercury_source,
source_tags:i.mercury_source_tags,
tags:i.tags&&i.tags.split(','),
threading_id:i.threading_id,
timestamp:i.timestamp,
action_type:c('MercuryActionType').USER_GENERATED_MESSAGE,
is_unread:i.is_unread,
folder:j,
sync_id:i.sync_id};


return k;}


f.exports={transform:h};}),null);

/** js/mercury/models/MercuryChannelHandlerDEPRECATED.js */











__d('MercuryChannelHandlerDEPRECATED',['Arbiter','ChannelConstants','LogHistory','MercuryActionType','MercuryChannelMessageTransformer','MercuryDelayedDispatcher','MercuryGlobalActionType','MercuryLogMessageType','MercuryMessages','MercuryPayloadSource','MercuryServerPayloadPreprocessor','MercurySingletonProvider','MercuryThreadInformer','MercuryViewer','MessagingEvent','MessagingTag','PresenceUtil','mixin'],(function a(b,c,d,e,f,g){

'use strict';





















var h=c('LogHistory').getInstance('mercury_channel_handler');i.









get=function(){
return j.get();};
i.

getForFBID=function(k){
return j.getForFBID(k);};


function i(k){
this.$MercuryChannelHandlerDEPRECATED_fbid=k;

this.__payloadPreprocessor=
c('MercuryServerPayloadPreprocessor').getForFBID(this.$MercuryChannelHandlerDEPRECATED_fbid);
this.$MercuryChannelHandlerDEPRECATED_threadInformer=c('MercuryThreadInformer').getForFBID(this.$MercuryChannelHandlerDEPRECATED_fbid);
this.$MercuryChannelHandlerDEPRECATED_mercuryMessages=c('MercuryMessages').getForFBID(this.$MercuryChannelHandlerDEPRECATED_fbid);
this.__delayedDispatcher=c('MercuryDelayedDispatcher').getForFBID(this.$MercuryChannelHandlerDEPRECATED_fbid);

this.$MercuryChannelHandlerDEPRECATED_subscriptions=[];}
i.prototype.

getInstanceFBID=function(){
return this.$MercuryChannelHandlerDEPRECATED_fbid;};
i.prototype.

$MercuryChannelHandlerDEPRECATED_changeFolder=function(k,l){
if(!this.$MercuryChannelHandlerDEPRECATED_isValidMessagingPayloadType(k)||
!l.obj.thread_fbids&&!l.obj.other_user_fbids)
return;


var m=c('MercuryPayloadSource').CLIENT_CHANNEL_MESSAGE,
n=void 0;
(l.obj.thread_fbids||[]).forEach(function(o){
if(l.obj.event==c('MessagingEvent').TAG){
n=l.obj.tag;}else 

n=l.obj.marked_as_spam?
c('MessagingTag').SPAM:
c('MessagingTag').INBOX;


var p=
{action_type:c('MercuryActionType').CHANGE_FOLDER,
thread_fbid:o.toString(),
other_user_fbid:null,
new_folder:n};

this.__delayedDispatcher.handleUpdateWaitForThread
({actions:[babelHelpers['extends']({},
p)],
payload_source:m},
o.toString());},


this);

(l.obj.other_user_fbids||[]).forEach(function(o){
if(l.obj.event==c('MessagingEvent').TAG){
n=l.obj.tag;}else 

n=l.obj.marked_as_spam?
c('MessagingTag').SPAM:
c('MessagingTag').INBOX;


var p=
{action_type:c('MercuryActionType').CHANGE_FOLDER,
other_user_fbid:o.toString(),
thread_fbid:null,
new_folder:n};

this.__delayedDispatcher.handleUpdateWaitForThread
({actions:[babelHelpers['extends']({},
p)],
payload_source:m},
o.toString());},


this);};
i.prototype.

$MercuryChannelHandlerDEPRECATED_updateTags=function(k,l){
if(!this.$MercuryChannelHandlerDEPRECATED_isValidMessagingPayloadType(k)||
!l.obj.tag)
return;


switch(l.obj.tag){
case c('MessagingTag').INBOX:
case c('MessagingTag').OTHER:
this.$MercuryChannelHandlerDEPRECATED_changeFolder(k,l);
break;}};

i.prototype.


__markAsSeen=function(k,l){
if(!this.$MercuryChannelHandlerDEPRECATED_isValidInboxPayloadType(k)||
!l.obj||
!l.obj.seen_timestamp)
return;


this.__payloadPreprocessor.handleUpdate
({message_counts:
[{seen_timestamp:l.obj.seen_timestamp,
folder:c('MessagingTag').INBOX}],

unseen_thread_fbids:
[{thread_fbids:[],
other_user_fbids:[],
folder:c('MessagingTag').INBOX}],

payload_source:c('MercuryPayloadSource').CLIENT_CHANNEL_MESSAGE});};

i.prototype.

__handleMessagingPayload=function(k,l){
switch(l.obj.event){
case c('MessagingEvent').TAG:
this.$MercuryChannelHandlerDEPRECATED_updateTags(k,l);
break;
case c('MessagingEvent').REPORT_SPAM:
this.$MercuryChannelHandlerDEPRECATED_changeFolder(k,l);
break;}};

i.prototype.

getRouting=function(){




return {messaging:this.__handleMessagingPayload,
inbox:this.__markAsSeen};};

i.prototype.

__getMessagingPayloadType=function(){
return c('ChannelConstants').getArbiterType('messaging');};
i.prototype.

__getMercuryPayloadType=function(){
return c('ChannelConstants').getArbiterType('mercury');};
i.prototype.

__getInboxPayloadType=function(){
return c('ChannelConstants').getArbiterType('inbox');};
i.prototype.

$MercuryChannelHandlerDEPRECATED_isValidMessagingPayloadType=function(k){
return k===this.__getMessagingPayloadType();};
i.prototype.

$MercuryChannelHandlerDEPRECATED_isValidMercuryPayloadType=function(k){
return k===this.__getMercuryPayloadType();};
i.prototype.

$MercuryChannelHandlerDEPRECATED_isValidInboxPayloadType=function(k){
return k===this.__getInboxPayloadType();};
i.prototype.

turnOn=function(){
if(!this.$MercuryChannelHandlerDEPRECATED_subscriptions.length){
var k=this.getRouting();

for(var l in k)
this.$MercuryChannelHandlerDEPRECATED_subscriptions.push(c('Arbiter').subscribe
(c('ChannelConstants').getArbiterType(l),
k[l].bind(this)));}



return this;};
i.prototype.

turnOff=function(){
if(this.$MercuryChannelHandlerDEPRECATED_subscriptions.length){
this.$MercuryChannelHandlerDEPRECATED_subscriptions.forEach(c('Arbiter').unsubscribe);
this.$MercuryChannelHandlerDEPRECATED_subscriptions=[];}

return this;};
i.prototype.

__shouldDropLogMessageBecauseOfSync=function(k){
switch(k.log_message_type){

case c('MercuryLogMessageType').UNSUBSCRIBE:
case c('MercuryLogMessageType').SUBSCRIBE:
case c('MercuryLogMessageType').THREAD_NAME:
case c('MercuryLogMessageType').VIDEO_CALL:
case c('MercuryLogMessageType').PHONE_CALL:
case c('MercuryLogMessageType').THREAD_IMAGE:
case c('MercuryLogMessageType').ORION:
case c('MercuryLogMessageType').PAGE_REPLY:
case c('MercuryLogMessageType').GENERIC_ADMIN_TEXT:
return true;


case c('MercuryLogMessageType').SERVER_ERROR:

case c('MercuryLogMessageType').LIVE_LISTEN:

case c('MercuryLogMessageType').SWITCH_TO_WORK:

case c('MercuryLogMessageType').WALLPAPER:


default:break;}

return false;};



var j=new (c('MercurySingletonProvider'))(i);

f.exports=i;}),null);

/** js/mercury/models/MercuryRoger.js */






__d('MercuryRoger',['Arbiter','ArbiterMixin','immutable','JSLogger','MercuryActionStatus','MercuryDispatcher','MercurySingletonProvider','MercuryThreads','mixin','mapObject'],(function a(b,c,d,e,f,g){

'use strict';var h,i,














j=c('MercuryActionStatus').SUCCESS;h=babelHelpers.inherits

(k,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;k.






getForFBID=function(o){
return l.getForFBID(o);};
k.

get=function(){
return l.get();};


function k(o){
i.constructor.call(this);
this.$MercuryRoger_readReceipts={};
this.$MercuryRoger_badReceipts=[];
this.$MercuryRoger_fbid=o;
this.$MercuryRoger_dispatcher=c('MercuryDispatcher').getForFBID(this.$MercuryRoger_fbid);
this.$MercuryRoger_mercuryThreads=c('MercuryThreads').getForFBID(this.$MercuryRoger_fbid);
this.$MercuryRoger_dispatcher.subscribe('update-roger',function(p,q){
for(var r in q){
var s=this.$MercuryRoger_readReceipts[r]||c('immutable').OrderedMap();
s=s.withMutations(function(t){
for(var u in q[r]){
var v=this.$MercuryRoger_mercuryThreads.getThreadMetaNow(r);
if(v&&v.participants)
if(v.participants.indexOf(u)==-1){
this.$MercuryRoger_badReceipts.push(n(this.$MercuryRoger_readReceipts));
continue;}


var w=t.get(u),
x=q[r][u];

if(!w||x.watermark>w.watermark)
t.set(u,x);}}.


bind(this));

this.$MercuryRoger_readReceipts[r]=s.sort
(function(t,u){return t.watermark-u.watermark;});}



q&&this.inform('change',q);}.
bind(this));
this.$MercuryRoger_dispatcher.subscribe('invalidate-global-state',function(){
this.$MercuryRoger_invalidateGlobalState();}.
bind(this));
c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,function(p,q){
var r={};
for(var s in this.$MercuryRoger_readReceipts)
if(Object.prototype.hasOwnProperty.call(this.$MercuryRoger_readReceipts,s))
r[s]=this.$MercuryRoger_readReceipts[s].toObject();


q.read_receipts=
{valid_receipts:r,
bad_receipts:this.$MercuryRoger_badReceipts};}.

bind(this));}
k.prototype.






getSeenBy=function(o,p){
if(!o)
return [];


var q=[],
r=this.$MercuryRoger_readReceipts[o.thread_id];
if(!r)
return q;


r.forEach(function(s,t){
if(m(o,s.watermark,t,p))
q.push(t);});



return q;};
k.prototype.

wasSeenByAll=function(o){
if(!o)
return false;


var p=this.$MercuryRoger_readReceipts[o.thread_id];
if(!p)
return false;


return p.every(function(q,r){return m
(o,
q.watermark,
r);});};

k.prototype.

getSeenTimestamps=function(o){
var p=this.$MercuryRoger_readReceipts[o];
if(!p){
p=c('immutable').OrderedMap();
this.$MercuryRoger_readReceipts[o]=p;}

return p;};
k.prototype.

getSeenTimestamp=function(o,p){
var q=this.$MercuryRoger_readReceipts[o];
return q?q.get(p):null;};
k.prototype.

$MercuryRoger_invalidateGlobalState=function(){
this.$MercuryRoger_readReceipts={};
this.$MercuryRoger_badReceipts=[];};



var l=new (c('MercurySingletonProvider'))(k);


function m
(o,
p,
q,
r){


return !!(p>=o.timestamp&&
(o.status===undefined||o.status===j)&&
(!r||q!=o.author));}





function n(o){
return c('mapObject')(o,function(p){return p.toJS();});}


f.exports=k;}),null);

/** js/mercury/models/MercuryDelayedRoger.js */












__d('MercuryDelayedRoger',['ArbiterMixin','LiveTimer','MercuryActionStatus','MercuryConfig','MercuryMessages','MercuryRoger','MercurySingletonProvider','MercuryThreadInformer','MercuryThreads','mixin','setTimeoutAcrossTransitions'],(function a(b,c,d,e,f,g){var h,i,













j=c('MercuryConfig')['roger.seen_delay'];h=babelHelpers.inherits

(k,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;k.












getForFBID=function(m){'use strict';
return l.getForFBID(m);};
k.

get=function(){'use strict';
return l.get();};


function k(m){'use strict';
i.constructor.call(this);this.































































































































$MercuryDelayedRoger_updatedMessages=function(event,n){
var o={};
for(var p in n)
if(this.$MercuryDelayedRoger_updateThread(p))
o[p]=true;


Object.keys(o).forEach
(function(q){return this.$MercuryDelayedRoger_emitChange(o);}.bind(this));}.

bind(this);this.$MercuryDelayedRoger_fbid=m;this.$MercuryDelayedRoger_mercuryRoger=c('MercuryRoger').getForFBID(m);this.$MercuryDelayedRoger_lastMessage={};this.$MercuryDelayedRoger_delayTimers={};this.$MercuryDelayedRoger_mercuryRoger.subscribe('change',function(n,o){for(var p in o)!this.$MercuryDelayedRoger_delayTimers[p]&&this.$MercuryDelayedRoger_informOnThread(p);}.bind(this));this.$MercuryDelayedRoger_mercuryThreadInformer=c('MercuryThreadInformer').getForFBID(m);this.$MercuryDelayedRoger_mercuryMessages=c('MercuryMessages').getForFBID(m);this.$MercuryDelayedRoger_mercuryThreads=c('MercuryThreads').getForFBID(m);this.$MercuryDelayedRoger_mercuryThreadInformer.subscribe('messages-received',this.$MercuryDelayedRoger_updatedMessages);this.$MercuryDelayedRoger_mercuryThreadInformer.subscribe('messages-reordered',this.$MercuryDelayedRoger_updatedMessages);this.$MercuryDelayedRoger_mercuryThreadInformer.subscribe('messages-updated',this.$MercuryDelayedRoger_updatedMessages);}k.prototype.getSeenBy=function(m,n){'use strict';if(this.$MercuryDelayedRoger_delayTimers[m])return [];return this.$MercuryDelayedRoger_mercuryRoger.getSeenBy(this.$MercuryDelayedRoger_getLastMessage(m),n);};k.prototype.wasSeenByAll=function(m){'use strict';if(this.$MercuryDelayedRoger_delayTimers[m])return false;return this.$MercuryDelayedRoger_mercuryRoger.wasSeenByAll(this.$MercuryDelayedRoger_getLastMessage(m));};k.prototype.$MercuryDelayedRoger_getLastMessage=function(m){'use strict';if(!this.$MercuryDelayedRoger_lastMessage[m]){var n=this.$MercuryDelayedRoger_mercuryThreads.getThreadMetaNow(m);if(n)this.$MercuryDelayedRoger_lastMessage[m]={thread_id:m,author:n.participants[0],timestamp:n.timestamp};}return this.$MercuryDelayedRoger_lastMessage[m];};k.prototype.$MercuryDelayedRoger_updateThread=function(m){'use strict';var n=false;this.$MercuryDelayedRoger_mercuryMessages.getThreadMessagesRange(m,0,1,function(o){var p=o[0];if(!p)return;var q=p.timestamp;if(p.status===c('MercuryActionStatus').SUCCESS)q-=c('LiveTimer').getServerTimeOffset();var r=this.getSeenBy(m);if(this.$MercuryDelayedRoger_delayTimers[m]){clearTimeout(this.$MercuryDelayedRoger_delayTimers[m]);delete this.$MercuryDelayedRoger_delayTimers[m];}var s=q+j,t=s-Date.now();if(t>0)this.$MercuryDelayedRoger_delayTimers[m]=c('setTimeoutAcrossTransitions')(function(){delete this.$MercuryDelayedRoger_delayTimers[m];this.$MercuryDelayedRoger_informOnThread(m);}.bind(this),t);this.$MercuryDelayedRoger_lastMessage[m]=p;var u=this.getSeenBy(m);if(r.length||u.length)n=true;}.bind(this));return n;};k.prototype.$MercuryDelayedRoger_informOnThread=function(m){'use strict';var n={};n[m]=true;this.$MercuryDelayedRoger_emitChange(n);};k.prototype.$MercuryDelayedRoger_emitChange=function(m){'use strict';this.inform('state-changed',m);this.inform('change');};


var l=new (c('MercurySingletonProvider'))(k);

f.exports=k;}),null);

/** js/mercury/models/MercuryDeliveryReceipts.js */






__d('MercuryDeliveryReceipts',['ArbiterMixin','Map','MercuryDispatcher','MercurySingletonProvider','mixin'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits








(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;




function j(l){'use strict';
i.constructor.call(this);
this.$MercuryDeliveryReceipts_fbid=l;
this.$MercuryDeliveryReceipts_receipts=new (c('Map'))();
this.$MercuryDeliveryReceipts_dispatcher=c('MercuryDispatcher').getForFBID(this.$MercuryDeliveryReceipts_fbid);
this.$MercuryDeliveryReceipts_dispatcher.subscribe('update-delivery',function(m,n){
if(n.delivery_receipts)
for(var o in n.delivery_receipts){
var p=n.delivery_receipts[o],
q=this.$MercuryDeliveryReceipts_receipts.get(o)||0;

if(p>q){
this.$MercuryDeliveryReceipts_receipts.set(o,p);
this.informDeliveryStatusChanged(o);}}}.



bind(this));}
j.

getForFBID=function(l){'use strict';
return k.getForFBID(l);};
j.

get=function(){'use strict';
return k.get();};
j.prototype.

informDeliveryStatusChanged=function(l){'use strict';
var m=new (c('Map'))();
m.set(l,true);

this.inform('change',m);};
j.prototype.

getDeliveryTime=function(l){'use strict';
return this.$MercuryDeliveryReceipts_receipts.get(l)||0;};



var k=new (c('MercurySingletonProvider'))(j);

f.exports=j;}),null);

/** js/mercury/models/MercuryDeliveryState.js */











__d('MercuryDeliveryState',['MercuryConfig','MercuryIDs','MercuryServerRequests','MercurySingletonProvider','MercuryThreadIDMap','MercuryThreadInformer','PresencePrivacy','UserActivity','debounceAcrossTransitions'],(function a(b,c,d,e,f,g){

'use strict';














var h=c('MercuryConfig').delivery_timeout||120000;i.










getForFBID=function(k){
return j.getForFBID(k);};
i.

get=function(){
return j.get();};


function i(k){
this.$MercuryDeliveryState_fbid=k;
this.$MercuryDeliveryState_serverRequests=c('MercuryServerRequests').getForFBID(this.$MercuryDeliveryState_fbid);
this.$MercuryDeliveryState_threadInformer=c('MercuryThreadInformer').getForFBID(this.$MercuryDeliveryState_fbid);
this.$MercuryDeliveryState_threadIDMap=c('MercuryThreadIDMap').getForFBID(this.$MercuryDeliveryState_fbid);

this.$MercuryDeliveryState_queuedMessages=[];
this.$MercuryDeliveryState_queuedThreads={};

this.$MercuryDeliveryState_threadInformer.subscribe
('messages-received',
this.$MercuryDeliveryState_handleMessages.bind(this));

c('UserActivity').subscribe
(c('debounceAcrossTransitions')(this.$MercuryDeliveryState_dispatchQueue,300,this));}

i.prototype.

$MercuryDeliveryState_handleMessages=
function(k,
l){

for(var m in l){
var n=l[m];
n.forEach(function(o){
if(this.$MercuryDeliveryState_validateMessage(o)){
this.$MercuryDeliveryState_queuedMessages.push(o);
this.$MercuryDeliveryState_threadIDMap.getServerIDFromClientID
(m,
function(p){
if(!this.$MercuryDeliveryState_queuedThreads[p])
this.$MercuryDeliveryState_queuedThreads[p]=[];

this.$MercuryDeliveryState_queuedThreads[p].push(o.message_id);}.
bind(this));}}.


bind(this));}


if(c('UserActivity').isActive(h))
this.$MercuryDeliveryState_dispatchQueue();};

i.prototype.

$MercuryDeliveryState_dispatchQueue=function(){
if(this.$MercuryDeliveryState_queuedMessages.length===0&&
Object.keys(this.$MercuryDeliveryState_queuedThreads).length===0)
return;


var k=this.$MercuryDeliveryState_queuedMessages.
map(function(l){return l.message_id;});
if(k)
this.$MercuryDeliveryState_serverRequests.sendDeliveryReceipts
(k,
this.$MercuryDeliveryState_queuedThreads);


this.$MercuryDeliveryState_queuedThreads={};
this.$MercuryDeliveryState_queuedMessages=[];};
i.prototype.

$MercuryDeliveryState_validateMessage=function(k){
var l=k.author?
c('MercuryIDs').getUserIDFromParticipantID(k.author):
null;

if(l===this.$MercuryDeliveryState_fbid)

return false;

if(!k.is_unread)

return false;

if(!c('PresencePrivacy').allows(l))

return false;


return true;};




var j=new (c('MercurySingletonProvider'))(i);

f.exports=i;}),null);

/** js/mercury/utils/MercuryFolders.js */




__d('MercuryFolders',['MercuryFoldersConfig','MessagingTag'],(function a(b,c,d,e,f,g){




var h=
[c('MessagingTag').INBOX,
c('MessagingTag').PENDING,
c('MessagingTag').OTHER,
c('MessagingTag').ACTION_ARCHIVED],


i=
{getSupportedFolders:function j(){
return h.filter(function(k){
if(k===c('MessagingTag').PENDING){
return !c('MercuryFoldersConfig').hide_message_filtered;}else
if(k===c('MessagingTag').OTHER)
return !c('MercuryFoldersConfig').hide_message_requests;

return true;}).
concat();},


getFromMeta:function j(k){
var l=k.folder;
if(k.is_archived)
l=c('MessagingTag').ACTION_ARCHIVED;


return l;}};



f.exports=i;}),null);

/** js/mercury/models/MercuryUnreadState.js */






__d('MercuryUnreadState',['invariant','MercuryFolders','LogHistory','KeyedCallbackManager','MercuryActionType','MercuryDispatcher','MercuryGlobalActionType','MercurySingletonProvider','MercuryThreadlistConstants','MercuryThreadIDMap','MessagingTag','MercuryServerRequests','MercuryThreadInformer','MercuryThreads','arrayContains','createObjectFrom'],(function a(b,c,d,e,f,g,h){

'use strict';





















var i=(c('MercuryFolders').getSupportedFolders()||[]).filter
(function(p){return p!==c('MessagingTag').ACTION_ARCHIVED;}),



j='unread_thread_hash',
k='unseen_thread_list',

l=c('MercuryThreadlistConstants').MAX_UNREAD_COUNT,

m=c('LogHistory').getInstance('mercury_unread_state');n.














getForFBID=function(p){
return o.getForFBID(p);};
n.

get=function(){
return o.get();};


function n(p){
this.$MercuryUnreadState_fbid=p;

this.$MercuryUnreadState_serverRequests=c('MercuryServerRequests').getForFBID(this.$MercuryUnreadState_fbid);
this.$MercuryUnreadState_threadIDMap=c('MercuryThreadIDMap').getForFBID(this.$MercuryUnreadState_fbid);
this.$MercuryUnreadState_threadInformer=c('MercuryThreadInformer').getForFBID(this.$MercuryUnreadState_fbid);
this.$MercuryUnreadState_threads=c('MercuryThreads').getForFBID(this.$MercuryUnreadState_fbid);
this.$MercuryUnreadState_dispatcher=c('MercuryDispatcher').getForFBID(this.$MercuryUnreadState_fbid);


this.$MercuryUnreadState_allReadTimestamp={};


this.$MercuryUnreadState_threadReadTimestamp={};

this.$MercuryUnreadState_initialUnreadCount={};
this.$MercuryUnreadState_maxCount={};
this.$MercuryUnreadState_unreadResources={};

i.forEach(function(q){
this.$MercuryUnreadState_initialUnreadCount[q]=0;
this.$MercuryUnreadState_maxCount[q]=false;
this.$MercuryUnreadState_unreadResources[q]=new (c('KeyedCallbackManager'))();}.
bind(this));

this.$MercuryUnreadState_dispatcher.subscribe
('update-unread',
this.$MercuryUnreadState_handleDispatchUpdateUnread.bind(this));


this.$MercuryUnreadState_dispatcher.subscribe('update-thread-ids',function(q,r){
this.$MercuryUnreadState_updateThreadIDs(r);}.
bind(this));}

n.prototype.

getUnreadCount=function(p){
if(this.exceedsMaxCount(p)){


m.error('unguarded_unread_count_fetch','{}');
return 0;}


return this.$MercuryUnreadState_getUnreadCountNow(p);};
n.prototype.

exceedsMaxCount=function(p){
return this.$MercuryUnreadState_maxCount[p]||
this.$MercuryUnreadState_getUnreadCountNow(p)>l;};
n.prototype.

markFolderAsRead=function(p){
if(this.$MercuryUnreadState_maxCount[p]||this.$MercuryUnreadState_getUnreadCountNow(p)>0)
this.$MercuryUnreadState_serverRequests.markFolderAsRead(p);};

n.prototype.

getIsThreadUnread=function(p,q){
var r=q||c('MessagingTag').INBOX,
s=this.$MercuryUnreadState_getUnreadThreadHashNow(r);
return !!(s&&s[p]);};
n.prototype.

$MercuryUnreadState_handleDispatchUpdateUnread=function(p,q){
this.$MercuryUnreadState_updateUnreadState(q);


var r=q.global_actions||[];

for(var s=0;s<r.length;s++){
var t=r[s];
if(t.action_type==c('MercuryGlobalActionType').MARK_ALL_READ)
this.$MercuryUnreadState_markAllThreadsRead(t.folder,t.timestamp);}};


n.prototype.

$MercuryUnreadState_setUnreadThreadIDsFromHash=
function(p,
q){

this.$MercuryUnreadState_unreadResources[p].setResource
(j,q);

this.$MercuryUnreadState_unreadResources[p].setResource
(k,Object.keys(q));};

n.prototype.

$MercuryUnreadState_getUnreadThreadHash=
function(p,
q){

var r=this.$MercuryUnreadState_unreadResources[p].executeOrEnqueue
(j,
q),

s=this.$MercuryUnreadState_unreadResources[p].
getUnavailableResources(r);

if(s.length)
this.$MercuryUnreadState_serverRequests.fetchUnreadThreadIDs(p);};

n.prototype.

$MercuryUnreadState_getUnreadThreadHashNow=
function(p){

return this.$MercuryUnreadState_unreadResources[p].getResource(j);};
n.prototype.

$MercuryUnreadState_getUnreadCountNow=
function(p){

var q=this.$MercuryUnreadState_unreadResources[p].
getResource(k);
if(q){
return q.length;}else 


return this.$MercuryUnreadState_initialUnreadCount[p];};

n.prototype.


$MercuryUnreadState_updateUnreadState=
function(p){

var q=void 0;
(p.unread_thread_fbids||[]).forEach(function(r){
q=r.folder;
if(!this.$MercuryUnreadState_isUnreadSupportedFolder(q))
return;

var s=r.thread_fbids||[];
s=s.concat
(r.other_user_fbids||[]);

var t=this.$MercuryUnreadState_convertThreadIDs(s);


this.$MercuryUnreadState_setUnreadThreadIDsFromHash
(q,
c('createObjectFrom')(t,true));

if(t.length>l)
this.$MercuryUnreadState_maxCount[q]=true;

this.$MercuryUnreadState_threadInformer.updatedUnreadState();}.
bind(this));

(p.message_counts||[]).forEach(function(r){
if(r.unread_count===undefined)
return;

q=r.folder;


if(r.unread_count>l){
this.$MercuryUnreadState_maxCount[q]=true;



this.$MercuryUnreadState_setUnreadThreadIDsFromHash(q,{});
this.$MercuryUnreadState_threadInformer.updatedUnreadState();}else{

this.$MercuryUnreadState_initialUnreadCount[q]=r.unread_count;



if(this.$MercuryUnreadState_initialUnreadCount[q]===0)
this.$MercuryUnreadState_setUnreadThreadIDsFromHash(q,{});


this.$MercuryUnreadState_threadInformer.updatedUnreadState();}}.

bind(this));

(p.actions||[]).forEach(function(r){
var s=c('MercuryActionType'),



t=r.other_user_fbid?
r.other_user_fbid:r.thread_fbid,
u=r.thread_id?
r.thread_id:
t;

if(r.action_type==s.DELETE_THREAD){
i.forEach(function(w){


this.$MercuryUnreadState_removeUnreadThread(w,u);}.
bind(this));}else
if(r.action_type==s.CHANGE_ARCHIVED_STATUS||
r.action_type==s.CHANGE_FOLDER){

var v=this.$MercuryUnreadState_threads.getThreadMetaNow(r.thread_id);
!!v||h(0,'We always have thread metadata for these actions.');
q=c('MercuryFolders').getFromMeta(v);

if(this.$MercuryUnreadState_isUnreadSupportedFolder(q)&&
v.unread_count>0)
this.$MercuryUnreadState_addUnreadThread(q,u);


i.forEach(function(w){
if(w!=q)





this.$MercuryUnreadState_removeUnreadThread(w,u);}.

bind(this));}else{

q=this.$MercuryUnreadState_getFolderFromAction(r);
if(!this.$MercuryUnreadState_isUnreadSupportedFolder(q))
return;


if(r.action_type==s.CHANGE_READ_STATUS){
if(r.mark_as_read){
this.$MercuryUnreadState_removeUnreadThread(q,u,r.timestamp);}else 

this.$MercuryUnreadState_addUnreadThread(q,u,r.timestamp);}else

if(r.action_type==s.USER_GENERATED_MESSAGE||
r.action_type==s.LOG_MESSAGE)



if(r.is_unread)
this.$MercuryUnreadState_addUnreadThread(q,u,r.timestamp);}}.



bind(this));};
n.prototype.

$MercuryUnreadState_addUnreadThread=
function(p,
q,
r){


if(this.$MercuryUnreadState_maxCount[p])
return;


this.$MercuryUnreadState_getUnreadThreadHash(p,function(s){
var t=this.$MercuryUnreadState_allReadTimestamp[p]||0,
u=this.$MercuryUnreadState_threadReadTimestamp[q]||0,


v=r||Number.POSITIVE_INFINITY;

if(v>=t&&
v>=u&&
!s[q]){
s[q]=r||0;
this.$MercuryUnreadState_setUnreadThreadIDsFromHash(p,s);
this.$MercuryUnreadState_threadInformer.updatedUnreadState();}}.

bind(this));};
n.prototype.

$MercuryUnreadState_removeUnreadThread=
function(p,
q,
r){


if(this.$MercuryUnreadState_maxCount[p])
return;


this.$MercuryUnreadState_getUnreadThreadHash(p,function(s){
if(r){
var t=this.$MercuryUnreadState_threadReadTimestamp[q];
if(!t||t<r)
this.$MercuryUnreadState_threadReadTimestamp[q]=r;}



var u=s[q];



if(r&&
typeof u=='number'&&
r<u)
return;


if(q in s){
delete s[q];
this.$MercuryUnreadState_setUnreadThreadIDsFromHash(p,s);
this.$MercuryUnreadState_threadInformer.updatedUnreadState();}}.

bind(this));};
n.prototype.

$MercuryUnreadState_markAllThreadsRead=
function(p,
q){


this.$MercuryUnreadState_maxCount[p]=false;
this.$MercuryUnreadState_setUnreadThreadIDsFromHash(p,{});

this.$MercuryUnreadState_allReadTimestamp[p]=
Math.max(this.$MercuryUnreadState_allReadTimestamp[p]||0,q||0);

this.$MercuryUnreadState_threadInformer.updatedUnreadState();};
n.prototype.

$MercuryUnreadState_convertThreadIDs=
function(p){




return p.map
(this.$MercuryUnreadState_threadIDMap.convertThreadIDIfAvailable,
this.$MercuryUnreadState_threadIDMap);};

n.prototype.

$MercuryUnreadState_updateThreadIDs=
function(p){

i.forEach(function(q){





var r=this.$MercuryUnreadState_getUnreadThreadHashNow(q);


if(!r)
return;


for(var s in p){
var t=p[s];

if(r[s]){

r[t]=
r[s];
delete r[s];}}










this.$MercuryUnreadState_setUnreadThreadIDsFromHash(q,r);}.
bind(this));};
n.prototype.






$MercuryUnreadState_getFolderFromAction=
function(p){

var q=p.thread_id?
this.$MercuryUnreadState_threads.getThreadMetaNow(p.thread_id):
null;

return q?
c('MercuryFolders').getFromMeta(q):
p.folder?p.folder:'';};
n.prototype.

$MercuryUnreadState_isUnreadSupportedFolder=function(p){
return c('arrayContains')(i,p);};



var o=new (c('MercurySingletonProvider'))(n);

f.exports=n;}),null);

/** js/mercury/models/MercuryUnseenState.js */






__d('MercuryUnseenState',['MercuryFolders','KeyedCallbackManager','LogHistory','MercuryActionType','MercuryDispatcher','MercurySingletonProvider','MercuryThreadIDMap','MercuryThreadInfo','MercuryThreadlistConstants','MessagingTag','MercuryServerRequests','MercuryThreadInformer','MercuryThreads','createObjectFrom','isEmpty'],(function a(b,c,d,e,f,g){

'use strict';


















var h=c('MercuryThreadlistConstants').MAX_UNSEEN_COUNT,

i='unseen_thread_hash',
j='unseen_thread_list',

k=c('LogHistory').getInstance('mercury_unseen_state');l.














getForFBID=function(n){
return m.getForFBID(n);};
l.

get=function(){
return m.get();};


function l(n){
this.$MercuryUnseenState_fbid=n;

this.$MercuryUnseenState_serverRequests=c('MercuryServerRequests').getForFBID(this.$MercuryUnseenState_fbid);
this.$MercuryUnseenState_threadIDMap=c('MercuryThreadIDMap').getForFBID(this.$MercuryUnseenState_fbid);
this.$MercuryUnseenState_threads=c('MercuryThreads').getForFBID(this.$MercuryUnseenState_fbid);
this.$MercuryUnseenState_threadInformer=c('MercuryThreadInformer').getForFBID(this.$MercuryUnseenState_fbid);
this.$MercuryUnseenState_dispatcher=c('MercuryDispatcher').getForFBID(this.$MercuryUnseenState_fbid);

this.$MercuryUnseenState_initialUnseenCount=0;
this.$MercuryUnseenState_lastSeenTimestamp=0;
this.$MercuryUnseenState_maxCount=false;
this.$MercuryUnseenState_pendingServerUpdates=false;


this.$MercuryUnseenState_unseenResources=new (c('KeyedCallbackManager'))();

this.$MercuryUnseenState_dispatcher.subscribe('update-unseen',function(o,p){
this.$MercuryUnseenState_updateStateFromPayload(p);}.
bind(this));

this.$MercuryUnseenState_dispatcher.subscribe('update-thread-ids',function(o,p){
this.$MercuryUnseenState_updateThreadIDs(p);}.
bind(this));}
l.prototype.

getUnseenCount=function(){
if(this.exceedsMaxCount()){


k.error('unguarded_unseen_count_fetch','{}');
return 0;}


return this.$MercuryUnseenState_getUnseenCountNow();};
l.prototype.

exceedsMaxCount=function(){
return this.$MercuryUnseenState_maxCount||this.$MercuryUnseenState_getUnseenCountNow()>h;};
l.prototype.




markAsSeen=function(){
var n=this.$MercuryUnseenState_getUnseenCountNow();
if(n===null){
this.$MercuryUnseenState_pendingServerUpdates=true;}else
if(n>0||this.$MercuryUnseenState_maxCount){

this.$MercuryUnseenState_serverRequests.markSeen();



this.$MercuryUnseenState_setFullState(this.$MercuryUnseenState_serverRequests.getLastActionTimestamp(),[]);}};

l.prototype.

$MercuryUnseenState_markThreadSeen=function(n,o){var p;
this.$MercuryUnseenState_removeUnseenThreadsWithTimestamp((p={},p[n]=0,p),o);};
l.prototype.

$MercuryUnseenState_setUnseenThreadIDsFromHash=function(n){
this.$MercuryUnseenState_unseenResources.setResource(i,n);
this.$MercuryUnseenState_unseenResources.setResource
(j,Object.keys(n));};

l.prototype.

$MercuryUnseenState_getUnseenThreadHash=function(n){
var o=this.$MercuryUnseenState_unseenResources.executeOrEnqueue
(i,
n),


p=this.$MercuryUnseenState_unseenResources.getUnavailableResources(o);
if(p.length)
this.$MercuryUnseenState_serverRequests.fetchUnseenThreadIDs();};

l.prototype.

$MercuryUnseenState_getUnseenThreadHashNow=function(){
return this.$MercuryUnseenState_unseenResources.getResource(i);};
l.prototype.

$MercuryUnseenState_getUnseenCountNow=function(){
var n=this.$MercuryUnseenState_unseenResources.getResource(j);
if(n){
return n.length;}else 


return this.$MercuryUnseenState_initialUnseenCount;};

l.prototype.

$MercuryUnseenState_updateStateFromPayload=function(n){


var o,p=this,
q=this.$MercuryUnseenState_getInboxMessageCounts(n);

if(n.unseen_thread_fbids){


n.unseen_thread_fbids.forEach(function(r){
if(r.folder!=c('MessagingTag').INBOX)


return;



var s=(r.thread_fbids||[]).
concat
(r.other_user_fbids||[]),


t=this.$MercuryUnseenState_convertThreadIDs(s),



u=q.seen_timestamp?
q.seen_timestamp:
this.$MercuryUnseenState_lastSeenTimestamp;


this.$MercuryUnseenState_setFullState(u,t);



if(q.unseen_count>h)
this.$MercuryUnseenState_maxCount=true;}.

bind(this));}else
if(q.seen_timestamp!==undefined){

this.$MercuryUnseenState_lastSeenTimestamp=q.seen_timestamp;

if(q.unseen_count>h){
this.$MercuryUnseenState_maxCount=true;



this.$MercuryUnseenState_setUnseenThreadIDsFromHash({});}else{

this.$MercuryUnseenState_initialUnseenCount=q.unseen_count;



if(this.$MercuryUnseenState_initialUnseenCount===0)
this.$MercuryUnseenState_setUnseenThreadIDsFromHash({});}}else{


var o=function(){var r;



if(p.$MercuryUnseenState_maxCount)
return {v:void 0};



var s=n.actions;

if(!s||!s.length)
return {v:void 0};


var t={},
u={},v=function x
(y){
var z=s[y],

aa=z.action_type,



ba=z.other_user_fbid?
z.other_user_fbid:z.thread_fbid,
ca=z.thread_id?
z.thread_id:
ba;

if(aa===c('MercuryActionType').MARK_THREAD_SEEN){
p.$MercuryUnseenState_markThreadSeen(ca,z.persistent);
return 'continue';}


if(!p.$MercuryUnseenState_actionIsInInbox(z))
return 'continue';


if(aa===c('MercuryActionType').USER_GENERATED_MESSAGE||
aa===c('MercuryActionType').LOG_MESSAGE){

var da=t[ca]?
z.timestamp>t[ca]:false,
ea=da||
!t[ca];
if(z.is_unread&&ea)
p.$MercuryUnseenState_threads.getThreadMeta(ca,function(fa){
var ga=false;
if(fa&&fa.last_read_timestamp)
if(fa.last_read_timestamp>=z.timestamp)
ga=true;


if(!c('MercuryThreadInfo').isMuted(fa)&&
!ga)
t[ca]=z.timestamp;});}else



if(aa===c('MercuryActionType').CHANGE_READ_STATUS&&
z.mark_as_read)


u[ca]=z.timestamp;};
for(var w=0;w<s.length;w++){var r=v(w);if(r==='continue')continue;}


p.$MercuryUnseenState_addUnseenThreadsWithTimestamp(t);
p.$MercuryUnseenState_removeUnseenThreadsWithTimestamp
(u);}();if(typeof o==="object")return o.v;}



if(this.$MercuryUnseenState_pendingServerUpdates){
this.$MercuryUnseenState_pendingServerUpdates=false;
this.markAsSeen();}};

l.prototype.





$MercuryUnseenState_setFullState=function(n,o){

var p=this.$MercuryUnseenState_getUnseenThreadHashNow();

if(p===undefined||
n>this.$MercuryUnseenState_lastSeenTimestamp||
this.$MercuryUnseenState_maxCount){
this.$MercuryUnseenState_lastSeenTimestamp=n;
o=o||[];


if(o.length<=h)
this.$MercuryUnseenState_maxCount=false;





var q={},



r=this.$MercuryUnseenState_getUnseenThreadHashNow();

for(var s in r)


if(r[s]!==true){
var t=r[s];
if(this.$MercuryUnseenState_isUnseenAction(t))
q[s]=t;}







var u=Object.assign
(c('createObjectFrom')(o,true),
q);


this.$MercuryUnseenState_setUnseenThreadIDsFromHash(u);
this.$MercuryUnseenState_threadInformer.updatedUnseenState();}};

l.prototype.





$MercuryUnseenState_addUnseenThreadsWithTimestamp=function(n){

if(this.$MercuryUnseenState_maxCount)
return;


var o={},
p=false;
for(var q in n){
var r=n[q];



if(this.$MercuryUnseenState_isUnseenAction(r)){
o[q]=r;
p=true;}}



if(!p)
return;


this.$MercuryUnseenState_getUnseenThreadHash(function(s){
for(var t in o){
var u=o[t];

if(!s[t]&&
this.$MercuryUnseenState_isUnseenAction(u))
s[t]=o[t];}




this.$MercuryUnseenState_setUnseenThreadIDsFromHash(s);
this.$MercuryUnseenState_threadInformer.updatedUnseenState();}.
bind(this));};
l.prototype.

$MercuryUnseenState_removeUnseenThreadsWithTimestamp=
function(n,
o){

if(!c('isEmpty')(n))
this.$MercuryUnseenState_getUnseenThreadHash(function(p){
var q=false;
for(var r in n){
var s=n[r],
t=s>=p[r];

if(p[r]&&(!s||t)){
delete p[r];
q=true;}}



if(q){
this.$MercuryUnseenState_setUnseenThreadIDsFromHash(p);
this.$MercuryUnseenState_threadInformer.updatedUnseenState();




if(o&&this.$MercuryUnseenState_getUnseenCountNow()===0)
this.$MercuryUnseenState_serverRequests.markSeen();}}.


bind(this));};

l.prototype.

$MercuryUnseenState_isUnseenAction=function(n){
return n>this.$MercuryUnseenState_lastSeenTimestamp;};
l.prototype.


$MercuryUnseenState_convertThreadIDs=function(n){



return n.map
(this.$MercuryUnseenState_threadIDMap.convertThreadIDIfAvailable,
this.$MercuryUnseenState_threadIDMap);};

l.prototype.

$MercuryUnseenState_updateThreadIDs=function(n){
var o=this.$MercuryUnseenState_getUnseenThreadHashNow();



if(!o)
return;


for(var p in n){
var q=n[p];

if(o[p]){

o[q]=
o[p];
delete o[p];}}





this.$MercuryUnseenState_setUnseenThreadIDsFromHash(o);};
l.prototype.





$MercuryUnseenState_actionIsInInbox=function(n){
var o=n.thread_id?
this.$MercuryUnseenState_threads.getThreadMetaNow(n.thread_id):
null,
p=o?c('MercuryFolders').getFromMeta(o):n.folder;

return p===c('MessagingTag').INBOX||p===undefined;};
l.prototype.

$MercuryUnseenState_getInboxMessageCounts=
function(n){

var o=n.message_counts||[];
for(var p=0;p<o.length;p++)

if(o[p].folder===c('MessagingTag').INBOX)
return o[p];



return {};};



var m=new (c('MercurySingletonProvider'))(l);

f.exports=l;}),null);

/** js/mercury/renderers/MercuryNotificationRenderer.js */





__d('MercuryNotificationRenderer',['fbt','MercuryAssert','MercuryIDs','MercuryMessages','MercuryParticipants','MercuryThreads','MercuryViewer','MessagingGenericAdminTextType'],(function a(b,c,d,e,f,g,h){



var i=c('MercuryMessages').get(),

j=c('MercuryThreads').get();






function k(l,m){
c('MercuryAssert').isThreadID(l);

j.getThreadMeta(l,function(n){
i.getThreadMessagesRange
(l,
0,
1,
function(o){
var p=o.length&&o[o.length-1];
if(p.log_message_type==
c('MessagingGenericAdminTextType').CONFIRM_FRIEND_REQUEST){
m(h._(["New contact added","191bb663a1fd661e9f42a0c98a9043f3"]));}else



if(p&&p.author!=c('MercuryViewer').getID()){
c('MercuryParticipants').get(p.author,function(q){
var r=q.short_name;
if(n.custom_nickname){
var s=c('MercuryIDs').getUserIDFromParticipantID(q.id);
if(n.custom_nickname[s])
r=n.custom_nickname[s];}


if(n.name){

m(h._(["{senderName} messaged {groupName}","01b1706f12194d09eb1ebade366d1ec5"],[h.param('senderName',r),h.param('groupName',n.name)]));}else
if(c('MercuryIDs').isGroupChat(l)){

m(h._(["{name} messaged your group","f56e43c312de35c97983ba2bfef7dde3"],
[h.param('name',r)]));}else 





m(h._(["{name} messaged you","36af2642c63fafbc5139e02d84e88935"],[h.param('name',r)]));});}else 





m(h._(["New message!","9ae94463a928e72cbdaf8d74ed56eec8"]));});});}






f.exports=





{renderDocumentTitle:k};}),null);

/** js/mercury/sync/init/MercurySyncEnvironment.js */













__d('MercurySyncEnvironment',['Arbiter','ChannelInitialData','CurrentUser','MercurySyncDeltaHandler'],(function a(b,c,d,e,f,g){

'use strict';






function h(){



if(!c('ChannelInitialData').channelConfig)
return;


c('MercurySyncDeltaHandler').get();
c('Arbiter').inform
('MercurySyncDeltaHandler/initSeqID',

{fbid:c('CurrentUser').getAccountID(),
seqID:c('ChannelInitialData').channelConfig.sequenceId});}




f.exports={setUp:h};}),null);

/** js/p2p/constants/P2PActionConstants.js */






__d('P2PActionConstants',[],(function a(b,c,d,e,f,g){

'use strict';

var h=

{CREDIT_CARDS_UPDATED:'credit_cards_updated',

CREDIT_CARDS_UPDATED_ERROR:'credit_cards_updated_error',

CHANNEL_EVENTS_ALLOWED:'channel_events_allowed',

CHANNEL_EVENTS_IGNORED:'channel_events_ignored',

CREDIT_CARD_SAVING:'credit_card_saving',

CREDIT_CARD_ADDED:'credit_card_added',

CREDIT_CARD_ADDED_ERROR:'credit_card_added_error',

CREDIT_CARD_ADDED_ERROR_CLEARED:'credit_card_added_error_cleared',

CREDIT_CARD_DELETED:'credit_card_deleted',

CREDIT_CARD_DELETED_ERROR:'credit_card_deleted_error',

CREDIT_CARD_UPDATED:'credit_card_updated',

CREDIT_CARD_UPDATED_ERROR:'credit_card_updated_error',

PRESET_CREDIT_CARD_UPDATED:'preset_credit_card_updated',

PRESET_CREDIT_CARD_UPDATED_ERROR:'preset_credit_card_updated_error',

CREDIT_CARD_VERIFIED:'credit_card_verified',

CREDIT_CARD_VERIFIED_ERROR:'credit_card_verified_error',

PAYMENT_METHODS_UPDATED:'payment_methods_updated',

PAYMENT_METHODS_UPDATED_ERROR:'payment_methods_updated_error',

TRANSFERS_UPDATED:'transfers_updated',

TRANSFERS_UPDATED_ERROR:'transfers_updated_error',

NUX_TRANSFERS_UPDATED:'nux_transfers_updated',

TRANSFER_ADDED:'transfer_added',

TRANSFER_ADDED_ERROR:'transfer_added_error',

TRANSFER_UPDATED:'transfer_updated',

TRANSFER_UPDATED_ERROR:'transfer_updated_error',

TRANSFER_ACCEPTED:'transfer_accepted',

TRANSFER_DECLINED:'transfer_declined',

CHAT_SEND_VIEW_OPENED:'chat_send_view_opened',

CHAT_SEND_VIEW_CLOSED:'chat_send_view_closed',

BIN_NUMBER_VALIDATED:'bin_number_validated',

BIN_NUMBER_VALIDATED_ERROR:'bin_number_validated_error',

USER_ELIGIBILITY_UDPATED:'user_eligibility_updated',

FRIENDS_LIST_UPDATED:'friends_list_updated',

DIALOG_SHOWN:'dialog_shown',

DIALOG_CLOSED:'dialog_closed',

BANNER_STATES_UPDATED:'banner_states_updated',

BANNER_DISMISSED:'banner_dismissed',

BANNER_VIEWED:'banner_viewed',

BANNER_COMPLETED:'banner_completed',

MONEYPENNY_TRANSFER_CREATED:'moneypenny_transfer_created',

MONEYPENNY_TRANSFER_CREATED_ERROR:'moneypenny_transfer_created_error',

PLATFORM_CONTEXT_ADDED:'platform_context_added',

PLATFORM_CONTEXT_ADDED_ERROR:'platform_context_added_error',

PLATFORM_CONTEXT_SAVE_ERRORS_CLEARED:'platform_context_save_errors_cleared',

PLATFORM_CONTEXT_BANNER_DISMISSED:'platform_context_banner_dismissed',

PLATFORM_CONTEXT_PRODUCT_ITEM_SOLD:'platform_context_product_item_sold',

PLATFORM_CONTEXT_CHANGED:'platform_context_changed',

EXTENSIVE_TRANSFER_DETAILS_UPDATED:'extensive_transfer_details_updated',

ADDRESS_SAVING:'address_saving',

ADDRESSES_UPDATED:'addresses_updated',

ADDRESS_ADDED:'address_added',

ADDRESS_ADDED_ERROR:'address_added_error',

ADDRESS_ADDED_ERROR_CLEARED:'address_added_error_cleared',

CHECKOUT_CART_INITIATED:'checkout_cart_initiated',

CHECKOUT_CART_CREATED:'checkout_cart_created',

CHECKOUT_SHIPPING_OPTION_SELECTED:'checkout_shipping_option_selected',

CHECKOUT_ADDRESS_SELECTED:'checkout_address_selected',

CHECKOUT_CREDIT_CARD_SELECTED:'checkout_credit_card_selected',

CHECKOUT_ADDRESS_FORM_TOGGLED:'checkout_address_form_toggled',

CHECKOUT_CREDIT_CARD_FORM_TOGGLED:'checkout_credit_card_form_toggled',

CHECKOUT_ADDRESS_EDIT_OPTIONS_TOGGLED:
'checkout_address_options_toggled',

CHECKOUT_CREDIT_CARD_EDIT_OPTIONS_TOGGLED:
'checkout_credit_card_edit_options_toggled',

CHECKOUT_PAYMENT_METHOD_EDIT_OPTIONS_TOGGLED:
'checkout_payment_edit_options_toggled',

CHECKOUT_PAYMENT_METHOD_SELECTED:'checkout_payment_method_selected',

CHECKOUT_PAYMENT_METHOD_CONFIGURED:'checkout_payment_method_configured',

CHECKOUT_PAYMENT_METHOD_CONFIRMED:'checkout_payment_method_confirmed',

CHECKOUT_ADDRESS_FORM_VALIDATED:'checkout_address_form_validated',

CHECKOUT_CREDIT_CARD_FORM_VALIDATED:'checkout_credit_card_form_validated',

CHECKOUT_EDIT_COMPLETED:'checkout_completed',

CHECKOUT_PROCESSING:'checkout_processing',

CHECKOUT_BUYER_PROFILE_UPDATED:'checkout_buyer_profile_updated',

CHECKOUT_MANUAL_PAYMENT_RECEIPT_UPDATED:
'checkout_manual_payment_receipt_updated',

PAYMENT_REQUEST_INITIATED:'payment_request_initiated',

PAYMENT_REQUEST_INITIATED_COMPLETE:'payment_request_initiated_completed',

PAYMENT_REQUEST_CREATED:'payment_request_created',

PAYMENT_REQUEST_CREATED_ERROR:'payment_request_created_error',

PAYMENT_REQUEST_UPDATED:'payment_request_updated',

PAYMENT_REQUEST_DECLINE_INITIATED:'payment_request_decline_initiated',

PAYMENT_REQUEST_DECLINED:'payment_request_declined',

PAYMENT_REQUEST_DECLINE_ERROR:'payment_request_decline_error',

PAYMENT_REQUESTS_FETCHED:'payment_requests_fetched',

PAYMENT_REQUEST_CANCEL_INITIATED:'payment_request_cancel_initiated',

PAYMENT_REQUEST_CANCELED:'payment_request_canceled',

PAYMENT_REQUEST_CANCEL_ERROR:'payment_request_cancel_error'};


f.exports=h;}),null);

/** js/p2p/dispatchers/P2PDispatcher.js */





__d('P2PDispatcher',['ExplicitRegistrationReactDispatcher'],(function a(b,c,d,e,f,g){

'use strict';var h,i;h=babelHelpers.inherits



(j,c('ExplicitRegistrationReactDispatcher'));i=h&&h.prototype;
function j(k){
i.constructor.call(this,k);
this.dispatch=this.dispatch.bind(this);}



f.exports=new j({strict:false});}),null);

/** js/p2p/stores/P2PDialogStore.js */






__d('P2PDialogStore',['EventEmitter','P2PActionConstants','P2PDispatcher'],(function a(b,c,d,e,f,g){

'use strict';var h,i,





j=void 0,
k={};h=babelHelpers.inherits

(l,c('EventEmitter'));i=h&&h.prototype;
function l(){
i.constructor.call(this);
j=c('P2PDispatcher').register(this.onEventDispatched.bind(this));
k=
{dialogClass:null,
dialogProps:null};}

l.prototype.

getState=function(){
return k;};
l.prototype.

onEventDispatched=function(m){
var n=m.type,
o=m.data;

switch(n){
case c('P2PActionConstants').DIALOG_SHOWN:
k.dialogClass=o.dialogClass;
k.dialogProps=o.dialogProps;
this.emit('change');
break;

case c('P2PActionConstants').DIALOG_CLOSED:
k.dialogClass=null;
k.dialogProps=null;
this.emit('change');
break;}};




f.exports=new l();}),null);

/** js/p2p/components/common/P2PDialogContainer.react.js */







__d('P2PDialogContainer.react',['P2PDialogStore','React'],(function a(b,c,d,e,f,g){

'use strict';var h,i;h=babelHelpers.inherits




(j,c('React').Component);i=h&&h.prototype;function j(){var k,l;for(var m=arguments.length,n=Array(m),o=0;o<m;o++)n[o]=arguments[o];return l=(k=i.constructor).call.apply(k,[this].concat(n)),this.
state=c('P2PDialogStore').getState(),this.













onDialogStoreChange=function(){
this.setState(c('P2PDialogStore').getState());}.
bind(this),l;}j.prototype.componentDidMount=function(){this.dialogStoreSub=c('P2PDialogStore').addListener('change',this.onDialogStoreChange);};j.prototype.componentWillUnmount=function(){if(this.dialogStoreSub){this.dialogStoreSub.remove();this.dialogStoreSub=null;}};j.prototype.

render=function(){
if(!this.state.dialogClass)
return null;

var k=this.state.dialogClass;
return c('React').createElement(k,babelHelpers['extends']({},this.state.dialogProps,{key:'dialog'}));};



f.exports=j;}),null);

/** js/pages/platform/message_attachment/PagesPlatformActionConstants.js */






__d('PagesPlatformActionConstants',[],(function a(b,c,d,e,f,g){

'use strict';

var h=
{BOOKING_REQUEST_ACCEPT_ERROR:'booking_request_accept_error',
BOOKING_REQUEST_ACCEPT_INITIATED:'booking_request_accept_initiated',
BOOKING_REQUEST_ACCEPTED:'booking_request_accepted',
BOOKING_REQUEST_CREATED:'booking_request_created',
BOOKING_REQUEST_DECLINE_ERROR:'booking_request_decline_error',
BOOKING_REQUEST_DECLINE_INITIATED:'booking_request_decline_initiated',
BOOKING_REQUEST_DECLINED:'booking_request_declined',
BOOKING_REQUEST_RESCHEDULE_INITIATED:'booking_request_reschedule_initiated',
BOOKING_REQUEST_RESCHEULED:'booking_request_reschedule',
DIALOG_CLOSED:'dialog_closed',
DIALOG_SHOWN:'dialog_shown',
NEW_TIME_CHOSEN:'new_time_chosen'};


f.exports=h;}),null);

/** js/pages/platform/message_attachment/PagesPlatformRequestDispatcher.js */





__d('PagesPlatformRequestDispatcher',['Dispatcher_DEPRECATED'],(function a(b,c,d,e,f,g){

'use strict';




f.exports=new (c('Dispatcher_DEPRECATED'))();}),null);

/** js/pages/platform/message_attachment/PagesPlatformDialogStore.js */






__d('PagesPlatformDialogStore',['EventEmitter','PagesPlatformActionConstants','PagesPlatformRequestDispatcher'],(function a(b,c,d,e,f,g){

'use strict';var h,i,





j={};h=babelHelpers.inherits

(k,c('EventEmitter'));i=h&&h.prototype;
function k(){
i.constructor.call(this);
c('PagesPlatformRequestDispatcher').register(this.onEventDispatched.bind(this));
j=
{dialogClass:null,
dialogProps:null};}

k.prototype.

getState=function(){
return j;};
k.prototype.

onEventDispatched=function(l){
var m=l.type,n=l.data;

switch(m){
case c('PagesPlatformActionConstants').DIALOG_SHOWN:
j.dialogClass=n.dialogClass;
j.dialogProps=n.dialogProps;
this.emit('change');
break;

case c('PagesPlatformActionConstants').DIALOG_CLOSED:
j.dialogClass=null;
j.dialogProps=null;
this.emit('change');
break;}};




f.exports=new k();}),null);

/** js/pages/platform/message_attachment/PagesPlatformDialogContainer.react.js */







__d('PagesPlatformDialogContainer.react',['PagesPlatformDialogStore','PureStoreBasedStateMixin','React'],(function a(b,c,d,e,f,g){

'use strict';





var h=c('React').createClass({displayName:'PagesPlatformDialogContainer',
mixins:[c('PureStoreBasedStateMixin')(c('PagesPlatformDialogStore'))],

statics:
{calculateState:function i(){
return c('PagesPlatformDialogStore').getState();}},



render:function i(){
if(!this.state.dialogClass)
return null;

var j=this.state.dialogClass;
return c('React').createElement(j,babelHelpers['extends']({},this.state.dialogProps,{key:'dialog'}));}});



f.exports=h;}),null);
